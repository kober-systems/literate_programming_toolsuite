<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.26">
<meta name="author" content="This is a suite of programs to use for literate programming. They try to">
<title>Literate programming toolsuite</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock pre>code{display:block}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.pygments .hll { background-color: #ffffcc }
pre.pygments { background: #f8f8f8; }
pre.pygments .tok-c { color: #3D7B7B; font-style: italic } /* Comment */
pre.pygments .tok-err { border: 1px solid #F00 } /* Error */
pre.pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
pre.pygments .tok-o { color: #666 } /* Operator */
pre.pygments .tok-ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
pre.pygments .tok-cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
pre.pygments .tok-cp { color: #9C6500 } /* Comment.Preproc */
pre.pygments .tok-cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
pre.pygments .tok-c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
pre.pygments .tok-cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
pre.pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
pre.pygments .tok-ge { font-style: italic } /* Generic.Emph */
pre.pygments .tok-ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
pre.pygments .tok-gr { color: #E40000 } /* Generic.Error */
pre.pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
pre.pygments .tok-gi { color: #008400 } /* Generic.Inserted */
pre.pygments .tok-go { color: #717171 } /* Generic.Output */
pre.pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
pre.pygments .tok-gs { font-weight: bold } /* Generic.Strong */
pre.pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
pre.pygments .tok-gt { color: #04D } /* Generic.Traceback */
pre.pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
pre.pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
pre.pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
pre.pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
pre.pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
pre.pygments .tok-kt { color: #B00040 } /* Keyword.Type */
pre.pygments .tok-m { color: #666 } /* Literal.Number */
pre.pygments .tok-s { color: #BA2121 } /* Literal.String */
pre.pygments .tok-na { color: #687822 } /* Name.Attribute */
pre.pygments .tok-nb { color: #008000 } /* Name.Builtin */
pre.pygments .tok-nc { color: #00F; font-weight: bold } /* Name.Class */
pre.pygments .tok-no { color: #800 } /* Name.Constant */
pre.pygments .tok-nd { color: #A2F } /* Name.Decorator */
pre.pygments .tok-ni { color: #717171; font-weight: bold } /* Name.Entity */
pre.pygments .tok-ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
pre.pygments .tok-nf { color: #00F } /* Name.Function */
pre.pygments .tok-nl { color: #767600 } /* Name.Label */
pre.pygments .tok-nn { color: #00F; font-weight: bold } /* Name.Namespace */
pre.pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
pre.pygments .tok-nv { color: #19177C } /* Name.Variable */
pre.pygments .tok-ow { color: #A2F; font-weight: bold } /* Operator.Word */
pre.pygments .tok-w { color: #BBB } /* Text.Whitespace */
pre.pygments .tok-mb { color: #666 } /* Literal.Number.Bin */
pre.pygments .tok-mf { color: #666 } /* Literal.Number.Float */
pre.pygments .tok-mh { color: #666 } /* Literal.Number.Hex */
pre.pygments .tok-mi { color: #666 } /* Literal.Number.Integer */
pre.pygments .tok-mo { color: #666 } /* Literal.Number.Oct */
pre.pygments .tok-sa { color: #BA2121 } /* Literal.String.Affix */
pre.pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
pre.pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
pre.pygments .tok-dl { color: #BA2121 } /* Literal.String.Delimiter */
pre.pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
pre.pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
pre.pygments .tok-se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
pre.pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
pre.pygments .tok-si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
pre.pygments .tok-sx { color: #008000 } /* Literal.String.Other */
pre.pygments .tok-sr { color: #A45A77 } /* Literal.String.Regex */
pre.pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
pre.pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
pre.pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
pre.pygments .tok-fm { color: #00F } /* Name.Function.Magic */
pre.pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
pre.pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
pre.pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
pre.pygments .tok-vm { color: #19177C } /* Name.Variable.Magic */
pre.pygments .tok-il { color: #666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Literate programming toolsuite</h1>
<div class="details">
<span id="author" class="author">This is a suite of programs to use for literate programming. They try to</span><br>
<span id="revdate">make this process as smooth as possible.</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_basic_design_decisions">Basic design decisions</a></li>
<li><a href="#_install">Install</a></li>
<li><a href="#build_instructions">Build from source</a>
<ul class="sectlevel2">
<li><a href="#_prerequisites">Prerequisites</a></li>
<li><a href="#_check_if_generated_files_are_untouched_in_vcs">Check if generated files are untouched in VCS</a></li>
<li><a href="#_generate_source_files">Generate source files</a></li>
<li><a href="#_build_and_test">Build and test</a></li>
<li><a href="#_build_websites_for_github_pages">Build websites for github pages</a></li>
</ul>
</li>
<li><a href="#_hacking_guide">Hacking Guide</a>
<ul class="sectlevel2">
<li><a href="#_poor_mans_ci">Poor mans ci</a></li>
<li><a href="#_ask_for_checkin_into_the_vcs">Ask for checkin into the VCS</a></li>
<li><a href="#_install_the_tools_on_our_computer">Install the tools on our computer</a></li>
</ul>
</li>
<li><a href="#_review_process">Review process</a></li>
<li><a href="#_release">Release</a></li>
<li><a href="#dockerfile">Dockerfile</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><span class="image"><a class="image" href="https://github.com/kober-systems/literate_programming_toolsuite"><img src="https://img.shields.io/github/languages/code-size/kober-systems/literate_programming_toolsuite?style=flat-square" alt="literate programming toolsuite?style=flat square"></a></span>
<span class="image"><a class="image" href="https://github.com/kober-systems/literate_programming_toolsuite/actions"><img src="https://img.shields.io/github/actions/workflow/status/kober-systems/literate_programming_toolsuite/rust.yml?style=flat-square" alt="rust"></a></span>
<span class="image"><a class="image" href="https://hub.docker.com/r/lammermann/lisi"><img src="https://img.shields.io/docker/image-size/lammermann/lisi/bleeding?label=docker&amp;style=flat-square" alt="bleeding?label=docker&amp;style=flat square"></a></span>
<span class="image"><a class="image" href="https://deps.rs/repo/github/kober-systems/literate_programming_toolsuite"><img src="https://deps.rs/repo/github/kober-systems/literate_programming_toolsuite/status.svg" alt="status"></a></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basic_design_decisions">Basic design decisions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This software is written in rust. It uses it&#8217;s own tools to gererate the
rust sourcecode.</p>
</div>
<div class="paragraph">
<p>Every logical part is seperated in its own subcrate. Most of those
subcrates define a cmdline util of the same name in this crate. In
everey subcrate folder we have a <code>&lt;name&gt;.adoc</code> file which is the main
source for that subcrate.</p>
</div>
<div class="paragraph">
<p>The subrates are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">asciidoctrine</dt>
<dd>
<p>An extensible <a href="asciidoctrine/asciidoctrine.html">asciidoc interpreter</a>. It
isn&#8217;t very mature right now.</p>
</dd>
<dt class="hdlist1">lisi</dt>
<dd>
<p>A flexible <a href="lisi/lisi.html">literate programming tool</a> for both tangle
and weave. It has some basic functionality right now.</p>
</dd>
<dt class="hdlist1">ansicht</dt>
<dd>
<p>A <a href="ansicht/ansicht.html">visual programming tool</a> primerily meant
to use in conjunction with literate programming tools. Currently just a draft.</p>
</dd>
<dt class="hdlist1">dolmetscher</dt>
<dd>
<p>A <a href="dolmetscher/dolmetscher.html">translation helper
tool</a>. Currently just a draft.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>I think asciidoc is superior to markdown so we use this as our basic
input format.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_install">Install</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To install and use this software there are some different options:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Download precompiled binaries</dt>
<dd>
<p>For windows you can download
<a href="https://nightly.link/kober-systems/literate_programming_toolsuite/actions/runs/8063422942/lisi-Windows.zip">latest
Windows binaries</a> built through github actions</p>
</dd>
<dt class="hdlist1">Use the docker image</dt>
<dd>
<p>You can use the precompiled image
<a href="https://hub.docker.com/r/lammermann/lisi">lammermann/lisi</a> from
Dockerhub. If you want to modify the code for the Dockerfile itself
you can find the code in a <a href="#dockerfile">seperate section</a>.</p>
</dd>
<dt class="hdlist1">Install from cargo</dt>
<dd>
<p>run <a id="install_with_cargo"></a><code>cargo install --force --path lisi</code></p>
</dd>
<dt class="hdlist1">Build from source</dt>
<dd>
<p>This makes most sense if you want to contribute to
the project or otherwise modify the code for personal use. You can
the find instructions <a href="#build_instructions">later in this document</a>.</p>
</dd>
<dt class="hdlist1">NixOS/nix</dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1">install</dt>
<dd>
<p><a id="install_with_nix"></a><code>nix-env -i -f lisi.nix</code></p>
</dd>
<dt class="hdlist1">build locally</dt>
<dd>
<p><code>nix-build lisi.nix</code></p>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="build_instructions">Build from source</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you want to modify how the programs work to suit your usecase you
will need build and compile the code.</p>
</div>
<div class="paragraph">
<p>There are a few steps to build the toolsuite.</p>
</div>
<div class="listingblock">
<div class="title">build.sh</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><div class="lineno"><table class="linenotable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><span class="tok-nb">set</span><span class="tok-w"> </span>-e<span class="tok-w"> </span><i class="conum" data-value="4"></i><b>(4)</b>

<span class="tok-s">&lt;&lt;check_generated_sources_are_vcs_clean&gt;&gt; </span><i class="conum" data-value="1"></i><b>(1)</b>

<span class="tok-s">&lt;&lt;generate_sources&gt;&gt;</span>
<span class="tok-s">&lt;&lt;build_and_test&gt;&gt;</span>
<span class="tok-s">&lt;&lt;update_docs&gt;&gt;</span>

<span class="tok-s">&lt;&lt;ask_for_vcs_check_</span>in&gt;&gt;<span class="tok-w"> </span><i class="conum" data-value="2"></i><b>(2)</b>

&lt;&lt;publish_on_crates_io&gt;&gt;

<span class="tok-s">&lt;&lt;ask_for_loca</span>l_install&gt;&gt;<span class="tok-w"> </span><i class="conum" data-value="3"></i><b>(3)</b>
</pre></div></td></tr></table></div></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If we have edited some of the generated sources by hand we may don&#8217;t want
them to be overwritten by our build process before we merged them back into
the asciidoc source.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Once our build succeds there is a good chance we want to save the changes to
our vcs.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>If everything went good we may want to install our new version of the
toolsuite locally.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>When a step fails we want the script to end</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_prerequisites">Prerequisites</h3>
<div class="paragraph">
<p>There must be some programms installed on your computer to release a version of
the <code>literate programming toolsuite</code>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">git</dt>
<dd>
<p>It is currently published on github so we need git.</p>
</dd>
<dt class="hdlist1">rust, cargo, etc</dt>
<dd>
<p>These porgramms are written in rust therefore we need the
rust toolchain.</p>
</dd>
<dt class="hdlist1">asciidoctor</dt>
<dd>
<p>Right now we need <code>asciidcotor</code> to build the docs. In future
versions it is planned to use our own <code>asciidoctrine</code> programm. There are some
additional dependencies for our doc generation process.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">asciidcotor-diagram</dt>
<dd>
<p>For our diagrams.</p>
</dd>
<dt class="hdlist1">ditaa</dt>
<dd>
<p>For our diagrams.</p>
</dd>
<dt class="hdlist1">pygments</dt>
<dd>
<p>For source code highlighting.</p>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_check_if_generated_files_are_untouched_in_vcs">Check if generated files are untouched in VCS</h3>
<div class="paragraph">
<p>Maybe we have edited some of our generated source files by hand. In that
case we would like to be warned before generating the files. This way we
could check if we want to put our changes into our asciidoc sources or
don&#8217;t care if they are overwritten.</p>
</div>
<div class="paragraph">
<p>We assume that all changed files that are not asciidoc files are
potentially in danger to be overwritten.</p>
</div>
<div id="check_generated_sources_are_vcs_clean" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span><span class="tok-nv">changed_files</span><span class="tok-o">=</span><span class="tok-sb">`</span>git<span class="tok-w"> </span>diff<span class="tok-w"> </span>--name-only<span class="tok-w"> </span><span class="tok-p">|</span><span class="tok-w"> </span>grep<span class="tok-w"> </span>--invert-match<span class="tok-w"> </span><span class="tok-s1">&#39;\.adoc$&#39;</span><span class="tok-sb">`</span>
<span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-o">[[</span><span class="tok-w"> </span>!<span class="tok-w"> </span>-z<span class="tok-w"> </span><span class="tok-s2">&quot;</span><span class="tok-nv">$changed_files</span><span class="tok-s2">&quot;</span><span class="tok-w"> </span><span class="tok-o">]]</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-k">then</span>
<span class="tok-w">  </span><span class="tok-k">while</span><span class="tok-w"> </span>true<span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-k">do</span>
<span class="tok-w">      </span><span class="tok-nb">echo</span><span class="tok-w"> </span><span class="tok-s2">&quot;some files are modified&quot;</span>
<span class="tok-w">      </span><span class="tok-nb">echo</span><span class="tok-w"> </span><span class="tok-s2">&quot;</span><span class="tok-nv">$changed_files</span><span class="tok-s2">&quot;</span>
<span class="tok-w">      </span><span class="tok-nb">read</span><span class="tok-w"> </span>-p<span class="tok-w"> </span><span class="tok-s2">&quot;Do you wish continue anyway? [yes|no] &quot;</span><span class="tok-w"> </span>yn
<span class="tok-w">      </span><span class="tok-k">case</span><span class="tok-w"> </span><span class="tok-nv">$yn</span><span class="tok-w"> </span><span class="tok-k">in</span>
<span class="tok-w">          </span><span class="tok-o">[</span>Yy<span class="tok-o">]</span>*<span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-k">break</span><span class="tok-p">;;</span>
<span class="tok-w">          </span><span class="tok-o">[</span>Nn<span class="tok-o">]</span>*<span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span>exit<span class="tok-p">;;</span>
<span class="tok-w">          </span>*<span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nb">echo</span><span class="tok-w"> </span><span class="tok-s2">&quot;Please answer yes or no.&quot;</span><span class="tok-p">;;</span>
<span class="tok-w">      </span><span class="tok-k">esac</span>
<span class="tok-w">  </span><span class="tok-k">done</span>
<span class="tok-k">fi</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_generate_source_files">Generate source files</h3>
<div id="generate_sources" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span><span class="tok-nb">echo</span><span class="tok-w"> </span><span class="tok-s2">&quot;Start generating source files ...&quot;</span>

<span class="tok-nb">cd</span><span class="tok-w"> </span>asciidoctrine/
lisi<span class="tok-w"> </span>-o<span class="tok-w"> </span>../docs/asciidoctrine/asciidoctrine.lisi.html<span class="tok-w"> </span>asciidoctrine.adoc<span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">  </span><span class="tok-o">||</span><span class="tok-w"> </span><span class="tok-nb">echo</span><span class="tok-w"> </span><span class="tok-s2">&quot;lisi is currenty not installed&quot;</span>
<span class="tok-nb">cd</span><span class="tok-w"> </span>..

<span class="tok-nb">cd</span><span class="tok-w"> </span>lisi
lisi<span class="tok-w"> </span>-o<span class="tok-w"> </span>/dev/null<span class="tok-w"> </span>lisi.adoc<span class="tok-w"> </span><span class="tok-o">||</span><span class="tok-w"> </span><span class="tok-nb">echo</span><span class="tok-w"> </span><span class="tok-s2">&quot;lisi is currenty not installed&quot;</span><span class="tok-w"> </span><i class="conum" data-value="1"></i><b>(1)</b>
<span class="tok-c1"># The new generated source must be able to</span>
<span class="tok-c1"># generate itself</span>
cargo<span class="tok-w"> </span>run<span class="tok-w"> </span>--manifest-path<span class="tok-w"> </span>../Cargo.toml<span class="tok-w"> </span>--bin<span class="tok-w"> </span>lisi<span class="tok-w"> </span>--<span class="tok-w"> </span>-o<span class="tok-w"> </span>lisi.html<span class="tok-w"> </span>lisi.adoc
<span class="tok-nb">cd</span><span class="tok-w"> </span>..

cargo<span class="tok-w"> </span>run<span class="tok-w"> </span>--bin<span class="tok-w"> </span>lisi<span class="tok-w"> </span>--<span class="tok-w"> </span>-o<span class="tok-w"> </span>/dev/null<span class="tok-w"> </span>README.adoc<span class="tok-w"> </span><i class="conum" data-value="2"></i><b>(2)</b>

<span class="tok-nb">echo</span><span class="tok-w"> </span><span class="tok-s2">&quot;Generating source files done!&quot;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We use a preinstalled version of <code>lisi</code> to build the sources. This helps us
if theres a bug in our generated sources. If we have no version of <code>lisi</code>
installed yet theres no problem the script will just give us a warning and
generate the sources in the next step.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Since <code>lisi</code> is currently unable to evaluate scripts with user cmdline input
we need to refresh the build script regulary.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_build_and_test">Build and test</h3>
<div id="build_and_test" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>cargo<span class="tok-w"> </span><span class="tok-nb">test</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_build_websites_for_github_pages">Build websites for github pages</h3>
<div class="paragraph">
<p>TODO later we want to do this with <code>asciidoctrine</code> alone.</p>
</div>
<div id="update_docs" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span><span class="tok-nb">echo</span><span class="tok-w"> </span><span class="tok-s2">&quot;Start generating html files ...&quot;</span>

asciidoctor<span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">            </span><span class="tok-s">&lt;&lt;asciidoctor-styles&gt;&gt;</span>
<span class="tok-s">            -D docs \</span>
<span class="tok-s">            README.adoc -o index.html</span>
<span class="tok-s">asciidoctor</span><span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">            </span><span class="tok-s">&lt;&lt;asciidoctor-styles&gt;&gt;</span>
<span class="tok-s">            -D docs/lisi \</span>
<span class="tok-s">            lisi/lisi.adoc</span>
<span class="tok-s">asciidoctor</span><span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">            </span><span class="tok-s">&lt;&lt;asciidoctor-styles&gt;&gt;</span>
<span class="tok-s">            -D docs/asciidoctrine \</span>
<span class="tok-s">            asciidoctrine/asciidoctrine.adoc</span>
<span class="tok-s">asciidoctor</span><span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">            </span><span class="tok-s">&lt;&lt;asciidoctor-styles&gt;&gt;</span>
<span class="tok-s">            -D docs/ansicht \</span>
<span class="tok-s">            ansicht/ansicht.adoc</span>
<span class="tok-s">asciidoctor</span><span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">            </span><span class="tok-s">&lt;&lt;asciidoctor-styles&gt;&gt;</span>
<span class="tok-s">            -D docs/dolmetscher \</span>
<span class="tok-s">            dolmetscher/dolmetscher.a</span>doc

<span class="tok-nb">echo</span><span class="tok-w"> </span><span class="tok-s2">&quot;Generating html files done!&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We have some general styles that should be equal in all of our files:</p>
</div>
<div id="asciidoctor-styles" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>-r<span class="tok-w"> </span>asciidoctor-diagram<span class="tok-w"> </span><span class="tok-se">\</span>
-a<span class="tok-w"> </span>source-highlighter<span class="tok-o">=</span>pygments<span class="tok-w"> </span><span class="tok-se">\</span>
-a<span class="tok-w"> </span><span class="tok-nv">toc</span><span class="tok-o">=</span>left<span class="tok-w"> </span><span class="tok-se">\</span>
-a<span class="tok-w"> </span><span class="tok-nv">icons</span><span class="tok-o">=</span>font<span class="tok-w"> </span><span class="tok-se">\</span>
-a<span class="tok-w"> </span><span class="tok-nv">toclevels</span><span class="tok-o">=</span><span class="tok-m">4</span><span class="tok-w"> </span><span class="tok-se">\</span>
-a<span class="tok-w"> </span>data-uri<span class="tok-w"> </span><span class="tok-se">\</span>
-a<span class="tok-w"> </span>reproducible<span class="tok-w"> </span><span class="tok-se">\</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hacking_guide">Hacking Guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you want to modify the code to fit your own needs you could follow
this describes my process of doing it:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Changing the sources</dt>
<dd>
<p>This is a literate program so the source of truth
here is the asciidoc document. However I often consider the literate
document and the generated source code as to differnt views on the
same programm. To keep them both in sync I make sure to commit any
changes I make at the generated source code to the VCS <strong>before</strong> I
regenerate the source code from the literate source. Than I can view
the diff between the generated source and my own modified version and
change the literate sources accodingly until the generated code does
not differ anymore from the one in VCS.<br>
When the two sources are in sync, than I can modify the literate
sources however I like and direkty regenerate the source code.</p>
</dd>
<dt class="hdlist1">Compile</dt>
<dd>
<p>I compile and test in a loop during the whole modification
process. For this I use watchexec as my own poor mans ci.</p>
</dd>
<dt class="hdlist1">Commit</dt>
<dd>
<p>When the bug is fixed or the feature is implemented etc I
commit my modifications to VCS.</p>
</dd>
<dt class="hdlist1">Check</dt>
<dd>
<p>After some time I reach a point where I want to release. Here I
do the following: Check the literate and generated sources are in
sync. Rerender the docs. Push to github. Let the ci do his work.</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="_poor_mans_ci">Poor mans ci</h3>
<div class="paragraph">
<p>Whenever the rust files change we want to rebuild and test the program.</p>
</div>
<div class="listingblock">
<div class="title">auto_build_loop.sh</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><div class="lineno"><table class="linenotable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span>watchexec<span class="tok-w"> </span>-w<span class="tok-w"> </span>.<span class="tok-w"> </span>-c<span class="tok-w"> </span>-e<span class="tok-w"> </span>rs,toml<span class="tok-w"> </span>--no-vcs-ignore<span class="tok-w"> </span>--<span class="tok-w"> </span><span class="tok-s2">&quot;&lt;&lt;build_and_test&gt;&gt;&quot;</span>
</pre></div></td></tr></table></div></code></pre>
</div>
</div>
<div class="paragraph">
<p>Whenever the asciidoc files change we want to regenerate the source
files. But before we can do that we have to make sure the aktual source
files and the generated source files are in sync.</p>
</div>
<div class="paragraph">
<p>TODO This isn&#8217;t easy because when the asciidoc files are moified they generate "dirty" source files (from the perspective of the VCS). So we have to stash the changes somehow so that it is seen, that the sources are in sync.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ask_for_checkin_into_the_vcs">Ask for checkin into the VCS</h3>
<div id="ask_for_vcs_check_in" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span><span class="tok-k">while</span><span class="tok-w"> </span>true<span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-k">do</span>
<span class="tok-w">    </span>git<span class="tok-w"> </span>diff<span class="tok-p">;</span><span class="tok-w"> </span><i class="conum" data-value="1"></i><b>(1)</b>
<span class="tok-w">    </span><span class="tok-nb">read</span><span class="tok-w"> </span>-p<span class="tok-w"> </span><span class="tok-s2">&quot;Do you wish to commit your changes to git? [yes|no] &quot;</span><span class="tok-w"> </span>yn
<span class="tok-w">    </span><span class="tok-k">case</span><span class="tok-w"> </span><span class="tok-nv">$yn</span><span class="tok-w"> </span><span class="tok-k">in</span>
<span class="tok-w">        </span><span class="tok-o">[</span>Yy<span class="tok-o">]</span>*<span class="tok-w"> </span><span class="tok-o">)</span>
<span class="tok-w">          </span>git<span class="tok-w"> </span>add<span class="tok-w"> </span>.<span class="tok-p">;</span><span class="tok-w"> </span><i class="conum" data-value="2"></i><b>(2)</b>
<span class="tok-w">          </span>git<span class="tok-w"> </span>commit<span class="tok-p">;</span><span class="tok-w"> </span><i class="conum" data-value="2"></i><b>(2)</b>
<span class="tok-w">          </span><span class="tok-k">break</span><span class="tok-p">;;</span>
<span class="tok-w">        </span><span class="tok-o">[</span>Nn<span class="tok-o">]</span>*<span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span>exit<span class="tok-p">;;</span>
<span class="tok-w">        </span>*<span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nb">echo</span><span class="tok-w"> </span><span class="tok-s2">&quot;Please answer yes or no.&quot;</span><span class="tok-p">;;</span>
<span class="tok-w">    </span><span class="tok-k">esac</span>
<span class="tok-k">done</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Before we commit everything we should do a last review.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Normally we know what we do and can just add everything and go on, but if we
saw something in the commit that we don&#8217;t want to include we should stop
before we submit the commit (by letting the commit message empty or by
changing the included chunks in another shell).</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_install_the_tools_on_our_computer">Install the tools on our computer</h3>
<div id="ask_for_local_install" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span><span class="tok-k">while</span><span class="tok-w"> </span>true<span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-k">do</span>
<span class="tok-w">    </span><span class="tok-nb">read</span><span class="tok-w"> </span>-p<span class="tok-w"> </span><span class="tok-s2">&quot;Do you wish to install this program? [yes|no] &quot;</span><span class="tok-w"> </span>yn
<span class="tok-w">    </span><span class="tok-k">case</span><span class="tok-w"> </span><span class="tok-nv">$yn</span><span class="tok-w"> </span><span class="tok-k">in</span>
<span class="tok-w">        </span><span class="tok-o">[</span>Yy<span class="tok-o">]</span>*<span class="tok-w"> </span><span class="tok-o">)</span>
<span class="tok-w">          </span><span class="tok-s">&lt;&lt;install_wi</span>th_nix&gt;&gt;<span class="tok-p">;</span>
<span class="tok-w">          </span><span class="tok-k">break</span><span class="tok-p">;;</span>
<span class="tok-w">        </span><span class="tok-o">[</span>Nn<span class="tok-o">]</span>*<span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span>exit<span class="tok-p">;;</span>
<span class="tok-w">        </span>*<span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nb">echo</span><span class="tok-w"> </span><span class="tok-s2">&quot;Please answer yes or no.&quot;</span><span class="tok-p">;;</span>
<span class="tok-w">    </span><span class="tok-k">esac</span>
<span class="tok-k">done</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_review_process">Review process</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Whenever the code is updated on the master branch or via pull request it
will be reviewed. The main part of that review follows the guidelines
documented in this section.</p>
</div>
<div class="paragraph">
<p>TODO github actions</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_release">Release</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When everything goes well it&#8217;s time to think about releasing.</p>
</div>
<div id="publish_on_crates_io" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>cargo<span class="tok-w"> </span>publish<span class="tok-w"> </span>--dry-run<span class="tok-w"> </span>-p<span class="tok-w"> </span>asciidoctrine

<span class="tok-k">while</span><span class="tok-w"> </span>true<span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-k">do</span>
<span class="tok-w">    </span><span class="tok-nb">read</span><span class="tok-w"> </span>-p<span class="tok-w"> </span><span class="tok-s2">&quot;Do you wish to publish asciidoctrine? [yes|no] &quot;</span><span class="tok-w"> </span>yn
<span class="tok-w">    </span><span class="tok-k">case</span><span class="tok-w"> </span><span class="tok-nv">$yn</span><span class="tok-w"> </span><span class="tok-k">in</span>
<span class="tok-w">        </span><span class="tok-o">[</span>Yy<span class="tok-o">]</span>*<span class="tok-w"> </span><span class="tok-o">)</span>
<span class="tok-w">          </span>cargo<span class="tok-w"> </span>login<span class="tok-p">;</span>
<span class="tok-w">          </span>cargo<span class="tok-w"> </span>publish<span class="tok-w"> </span>--dry-run<span class="tok-w"> </span>-p<span class="tok-w"> </span>asciidoctrine<span class="tok-p">;</span>
<span class="tok-w">          </span><span class="tok-k">break</span><span class="tok-p">;;</span>
<span class="tok-w">        </span><span class="tok-o">[</span>Nn<span class="tok-o">]</span>*<span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span>exit<span class="tok-p">;;</span>
<span class="tok-w">        </span>*<span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nb">echo</span><span class="tok-w"> </span><span class="tok-s2">&quot;Please answer yes or no.&quot;</span><span class="tok-p">;;</span>
<span class="tok-w">    </span><span class="tok-k">esac</span>
<span class="tok-k">done</span>

cargo<span class="tok-w"> </span>publish<span class="tok-w"> </span>--dry-run<span class="tok-w"> </span>-p<span class="tok-w"> </span>lisi

<span class="tok-k">while</span><span class="tok-w"> </span>true<span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-k">do</span>
<span class="tok-w">    </span><span class="tok-nb">read</span><span class="tok-w"> </span>-p<span class="tok-w"> </span><span class="tok-s2">&quot;Do you wish to publish lisi? [yes|no] &quot;</span><span class="tok-w"> </span>yn
<span class="tok-w">    </span><span class="tok-k">case</span><span class="tok-w"> </span><span class="tok-nv">$yn</span><span class="tok-w"> </span><span class="tok-k">in</span>
<span class="tok-w">        </span><span class="tok-o">[</span>Yy<span class="tok-o">]</span>*<span class="tok-w"> </span><span class="tok-o">)</span>
<span class="tok-w">          </span>cargo<span class="tok-w"> </span>login<span class="tok-p">;</span>
<span class="tok-w">          </span>cargo<span class="tok-w"> </span>publish<span class="tok-w"> </span>--dry-run<span class="tok-w"> </span>-p<span class="tok-w"> </span>lisi<span class="tok-p">;</span>
<span class="tok-w">          </span><span class="tok-k">break</span><span class="tok-p">;;</span>
<span class="tok-w">        </span><span class="tok-o">[</span>Nn<span class="tok-o">]</span>*<span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span>exit<span class="tok-p">;;</span>
<span class="tok-w">        </span>*<span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nb">echo</span><span class="tok-w"> </span><span class="tok-s2">&quot;Please answer yes or no.&quot;</span><span class="tok-p">;;</span>
<span class="tok-w">    </span><span class="tok-k">esac</span>
<span class="tok-k">done</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dockerfile">Dockerfile</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use <code>lisi</code> in ci-scripts (at least thats my usecase) it is very handy to have a docker image at hand. However when it comes to docker images size is key. For this reason we use to <a href="https://docs.docker.com/develop/develop-images/multistage-build/">multiple different stages</a> in our Dockerfile:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>one that builds our software and has all the build dependencies</p>
</li>
<li>
<p>one that only holds our final binaries and minimal runtime dependencies to enable a small image size.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Dockerfile</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="Dockerfile"><div class="lineno"><table class="linenotable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span>&lt;&lt;docker_build_step&gt;&gt;

&lt;&lt;docker_final_image_step&gt;&gt;
</pre></div></td></tr></table></div></code></pre>
</div>
</div>
<div class="paragraph">
<p>To build binaries that later have minimal runtime dependencies we use the <a href="https://musl.libc.org/">musl</a> target which lets us build statically compiled binaries. To do this we use the rust docker image based on <a href="https://www.alpinelinux.org/">alpine</a></p>
</div>
<div id="docker_build_step" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="Dockerfile"><span></span>FROM rust:alpine AS builder

RUN apk --no-cache add g++ <i class="conum" data-value="1"></i><b>(1)</b>

WORKDIR /home/rust/
COPY . .
RUN cargo test
RUN cargo build --release

RUN strip target/release/lisi <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We can only compile on this system if we have <code>g++</code> installed for some weird reason I don&#8217;t understand (see the related bug <a href="https://github.com/rust-lang/cargo/issues/7563">here</a>).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>After building the binaries we can shrink down the size significantly by striping them.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After we build our program we take a fresh image based on alpine (becase it&#8217;s small) and copy only our binaries over.</p>
</div>
<div id="docker_final_image_step" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="Dockerfile"><span></span>FROM alpine:latest
WORKDIR /home/lisi
COPY --from=builder /home/rust/target/release/lisi .
ENV PATH=&quot;${PATH}:/home/lisi&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>TODO github actions for docker image</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
</div>
</div>
</body>
</html>