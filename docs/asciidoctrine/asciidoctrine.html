<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<meta name="author" content="Benjamin Kober">
<title>ASCIIdoctrine</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.pygments .hll { background-color: #ffffcc }
pre.pygments { background: #f8f8f8; }
pre.pygments .tok-c { color: #408080; font-style: italic } /* Comment */
pre.pygments .tok-err { border: 1px solid #FF0000 } /* Error */
pre.pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
pre.pygments .tok-o { color: #666666 } /* Operator */
pre.pygments .tok-ch { color: #408080; font-style: italic } /* Comment.Hashbang */
pre.pygments .tok-cm { color: #408080; font-style: italic } /* Comment.Multiline */
pre.pygments .tok-cp { color: #BC7A00 } /* Comment.Preproc */
pre.pygments .tok-cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
pre.pygments .tok-c1 { color: #408080; font-style: italic } /* Comment.Single */
pre.pygments .tok-cs { color: #408080; font-style: italic } /* Comment.Special */
pre.pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
pre.pygments .tok-ge { font-style: italic } /* Generic.Emph */
pre.pygments .tok-gr { color: #FF0000 } /* Generic.Error */
pre.pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
pre.pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
pre.pygments .tok-go { color: #888888 } /* Generic.Output */
pre.pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
pre.pygments .tok-gs { font-weight: bold } /* Generic.Strong */
pre.pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
pre.pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
pre.pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
pre.pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
pre.pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
pre.pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
pre.pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
pre.pygments .tok-kt { color: #B00040 } /* Keyword.Type */
pre.pygments .tok-m { color: #666666 } /* Literal.Number */
pre.pygments .tok-s { color: #BA2121 } /* Literal.String */
pre.pygments .tok-na { color: #7D9029 } /* Name.Attribute */
pre.pygments .tok-nb { color: #008000 } /* Name.Builtin */
pre.pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
pre.pygments .tok-no { color: #880000 } /* Name.Constant */
pre.pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
pre.pygments .tok-ni { color: #999999; font-weight: bold } /* Name.Entity */
pre.pygments .tok-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
pre.pygments .tok-nf { color: #0000FF } /* Name.Function */
pre.pygments .tok-nl { color: #A0A000 } /* Name.Label */
pre.pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
pre.pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
pre.pygments .tok-nv { color: #19177C } /* Name.Variable */
pre.pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
pre.pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
pre.pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
pre.pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
pre.pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
pre.pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
pre.pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
pre.pygments .tok-sa { color: #BA2121 } /* Literal.String.Affix */
pre.pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
pre.pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
pre.pygments .tok-dl { color: #BA2121 } /* Literal.String.Delimiter */
pre.pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
pre.pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
pre.pygments .tok-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
pre.pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
pre.pygments .tok-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
pre.pygments .tok-sx { color: #008000 } /* Literal.String.Other */
pre.pygments .tok-sr { color: #BB6688 } /* Literal.String.Regex */
pre.pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
pre.pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
pre.pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
pre.pygments .tok-fm { color: #0000FF } /* Name.Function.Magic */
pre.pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
pre.pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
pre.pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
pre.pygments .tok-vm { color: #19177C } /* Name.Variable.Magic */
pre.pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>ASCIIdoctrine</h1>
<div class="details">
<span id="author" class="author">Benjamin Kober</span><br>
<span id="email" class="email"><a href="mailto:k.o.b.e.r@web.de">k.o.b.e.r@web.de</a></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_einstieg">Einstieg</a></li>
<li><a href="#_übersicht">Übersicht</a>
<ul class="sectlevel2">
<li><a href="#_motivation_und_hintergrund">Motivation und Hintergrund</a></li>
<li><a href="#_programmarchitektur">Programmarchitektur</a></li>
</ul>
</li>
<li><a href="#_implementierung">Implementierung</a>
<ul class="sectlevel2">
<li><a href="#input-format">Eingabeformate</a>
<ul class="sectlevel3">
<li><a href="#_asciidoc">Asciidoc</a>
<ul class="sectlevel4">
<li><a href="#_grundlegender_aufbau_eines_asciidoc_dokuments">Grundlegender Aufbau eines Asciidoc Dokuments</a></li>
<li><a href="#_document_header">Document Header</a></li>
<li><a href="#_überschriften">Überschriften</a></li>
<li><a href="#_absätze">Absätze</a></li>
<li><a href="#_listen">Listen</a></li>
<li><a href="#_links">Links</a></li>
<li><a href="#_querverweise">Querverweise</a></li>
<li><a href="#_fußnoten">Fußnoten</a></li>
<li><a href="#_bilder">Bilder</a></li>
<li><a href="#_tabellen">Tabellen</a></li>
</ul>
</li>
<li><a href="#_json">Json</a></li>
</ul>
</li>
<li><a href="#output-format">Ausgabeformate</a>
<ul class="sectlevel3">
<li><a href="#html5">Html5</a>
<ul class="sectlevel4">
<li><a href="#_überschriften_2">Überschriften</a></li>
<li><a href="#_absätze_2">Absätze</a></li>
<li><a href="#_listen_2">Listen</a></li>
<li><a href="#_sourcecode_blocke">Sourcecode Blocke</a></li>
<li><a href="#_links_2">Links</a></li>
<li><a href="#_querverweise_2">Querverweise</a></li>
<li><a href="#_fußnoten_2">Fußnoten</a></li>
<li><a href="#_bilder_2">Bilder</a></li>
<li><a href="#_tabellen_2">Tabellen</a></li>
<li><a href="#_inhaltsverzeichnis">Inhaltsverzeichnis</a></li>
</ul>
</li>
<li><a href="#_json_2">Json</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_asciidoctrine_in_andere_programme_einbinden">asciidoctrine in andere Programme einbinden</a>
<ul class="sectlevel2">
<li><a href="#cmd-api">Aufruf auf der Kommandozeile</a></li>
</ul>
</li>
<li><a href="#extensions">asciidoctrine erweitern</a>
<ul class="sectlevel2">
<li><a href="#reader">Neue Datenformate einlesen</a></li>
<li><a href="#extension">Den AST verarbeiten/modifizieren</a></li>
<li><a href="#writer">Neue Ausgabeformate unterstützen</a></li>
<li><a href="#ast">Der Abstract Syntax Tree</a></li>
</ul>
</li>
<li><a href="#_tmp_implementierung">tmp Implementierung</a></li>
<li><a href="#_installation">Installation</a></li>
<li><a href="#_build">Build</a></li>
<li><a href="#_tests">Tests</a>
<ul class="sectlevel2">
<li><a href="#_testumgebung">Testumgebung</a></li>
</ul>
</li>
<li><a href="#_verwandte_projekte">Verwandte Projekte</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Eine asciidoc Implementierung in rust.</p>
</div>
<div class="paragraph">
<p>ASCIIdoctrine will möglichst kompatibel zur asciidoc Interpretation von <a href="http://asciidoctor.org">asciidoctor</a> sein, so dass es als Drop-in Ersatz genutzt werden kann. Allerdings ist es in <a href="https://www.rust-lang.org/">rust</a> geschrieben und hat das Ziel flexibeler und leichter zu portieren zu sein.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_einstieg">Einstieg</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Je nach Interessenlage und Beweggrund zum lesen dieses Artikels wird man
unterschiedlich an ihn herangehen.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Will man einfach Texte mit <code>asciidoc</code> Markup verfassen sollte man zum
<a href="#asciidoc-syntax">ASCIIdoc Syntax</a> Abschnitt gehen oder zur Beschreibung
der <a href="#cmd-api">Kommandozeilenparameter</a>.</p>
</li>
<li>
<p>Will man wissen wie das Programm funktioniert oder es anpassen kann man
einfach weiterlesen.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_übersicht">Übersicht</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dieses Programm ist im <a href="https://en.wikipedia.org/wiki/Literate_programming">literate programming</a> Stil geschrieben. Gie Grundidee ist eine ASCIIdoc Benutzeranleitung so umzuarbeiten, dass sie sich automatisch zu einem ausführbaren Programm mit Tests kompilieren lässt.</p>
</div>
<div class="paragraph">
<p>Dazu verwenden wir <a href="https://lammermann.github.io/literate_programming_toolsuite/lisa/lisa.html">lisa</a> (welches im gleichen Repo verwaltet wird) als Werkzeug.</p>
</div>
<div class="sect2">
<h3 id="_motivation_und_hintergrund">Motivation und Hintergrund</h3>
<div class="paragraph">
<p>Das Programm <a href="http://jgm.github.io/lunamark/doc/lunamark.html">lunamark</a> hat
ursprünglich mein Interesse für <a href="http://www.lua.org">lua</a>,
<a href="http://www.inf.puc-rio.br/~roberto/lpeg/">lpeg</a> und die Implementierung von
Parsern im Allgemeinen geweckt. Ich war begeistert wie der Eingabetext mit
Mustern abgesucht und umgewandelt wurde (vorher kannte ich nur
<a href="https://en.wikipedia.org/wiki/Regular_expression">regular expressions</a> und wäre
bei solch komplexen Aufgaben sofort an Grenzen gestoßen).</p>
</div>
<div class="paragraph">
<p>Ich fing an einen asciidoc parser für lunamark zu schreiben. Nach einiger Zeit
stellten sich ein paar Probleme heraus:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>lunamark ist für <a href="https://daringfireball.net/projects/markdown/">markdown</a>
geschrieben und das ist nicht für beliebig komplexe Dokumente geeignet.</p>
</li>
<li>
<p>Der Eingabetext wird sofort in das Ausgabeformat umgewandelt und nicht in
einen <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree">AST</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Das zweite Problem ist in meinem Fall problematischer als das erste, da ich das Werkzeug nicht nur benutzen will um Dokumente zu erstellen. Hat man einen AST kann man nach belieben filtern, umsortieren, bearbeiten und in völlig andere Formate einbauen.</p>
</div>
</div>
<div class="sect2">
<h3 id="_programmarchitektur">Programmarchitektur</h3>
<div class="paragraph">
<p>Aus diesem Grund soll dieses Programm mehrschrittig vorgehen und alle Dateien
zunächst in einen AST umwandeln:</p>
</div>
<div id="dataflow-outline" class="imageblock">
<div class="content">
<img src="data:image/png;base64,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" alt="diag 05e4fe35b426d05d2bf76cf78fd60273" width="1150" height="308">
</div>
<div class="title">Figure 1. Module und Datenstrom in asciidoctrine</div>
</div>
<div class="paragraph">
<p>So kann man einerseits leicht unterschiedliche <a href="#generate-output">Ausgabeformate</a> unterstützen und andererseits eine <a href="#api">[api]</a> zur Verfügung stellen, die Zugriff auf die gesamte Dokumentstruktur gibt.</p>
</div>
<div class="paragraph">
<p>Der generelle Ablauf ist folgendermaßen:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Die Eingabedatei(en) wird(werden) eingelesen</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Diese wird von einem <a href="#reader">Neue Datenformate einlesen</a> eingelesen und in einen AST umgewandelt.</p>
</li>
<li>
<p>Der <a href="#reader">Neue Datenformate einlesen</a> wird nur einmal ausgewählt und ist (im Fall von mehreren
Eingabedateien) für alle Eingabedateien gleich.</p>
</li>
<li>
<p>Das standardmäßige Eingabeformat ist <a href="#asciidoc-syntax">[asciidoc-syntax]</a>.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Der AST wird von einer oder mehreren Erweiterungen modifiziert</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Jede <a href="#extensions">Erweiterung</a> bekommt einen AST als Parameter übergeben
und gibt einen AST zurück.</p>
</li>
<li>
<p>Erweiterungen können über die <a href="#cmd-api">Kommandozeile</a> oder die <a href="#api">[api]</a>
weitere Parameter und Steuerungsdateien (von beliebigem Format) übergeben
werden.</p>
</li>
<li>
<p>Es können beliebig viele Erweiterungen in beliebiger Reihenfolge
hintereinander geschaltet werden.</p>
</li>
<li>
<p>Ob eine Erweiterung eigene Ausgabedateien erzeugt, bleibt ihr selbst
überlassen.</p>
</li>
<li>
<p>Standardmäßig sind keine Erweiterungen aktiviert.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Ein Output Prozessor (Writer) wandelt den AST in eine Ausgabedatei um</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Der Writer kann über die <a href="#cmd-api">Kommandozeile</a> oder die <a href="#api">[api]</a> Parameter
oder Styledateien (wie css-Stylesheets etc) übergeben bekommen.</p>
</li>
<li>
<p>Das standardmäßige Ausgabeformat ist <a href="#html5">Html5</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementierung">Implementierung</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>asciidoctrine</code> ist ein rust Programm. Der Hauptteil des Programms ist in einer
Bibliothek implementiert. Ein kleiner Teil ist ein Kommandozeilenprogramm
welches diese Bibliothek benutzt und die Parameter übergibt.</p>
</div>
<div class="listingblock">
<div class="title">src/lib.rs</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><table class="linenotable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><pre><span></span><span class="tok-o">&lt;&lt;</span><span class="tok-n">crate_usages</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"></span>

<span class="tok-o">&lt;&lt;</span><span class="tok-n">internal_modules</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"></span>

<span class="tok-o">&lt;&lt;</span><span class="tok-n">public_structs</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"></span>

<span class="tok-o">&lt;&lt;</span><span class="tok-n">interfaces</span><span class="tok-o">|</span><span class="tok-n">join</span><span class="tok-o">=</span><span class="tok-s">&quot;</span><span class="tok-se">\n\n</span><span class="tok-s">&quot;</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"></span>
</pre></td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Die Bibliothek wiederum teilt den Großteil ihrer Aufgaben einigen abgetrennten
Modulen zu:</p>
</div>
<div id="internal_modules" class="listingblock">
<div class="title">Module innerhalb des crates</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-k">mod</span> <span class="tok-nn">ast</span><span class="tok-p">;</span><span class="tok-w">         </span><i class="conum" data-value="1"></i><b>(1)</b>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">ast</span>::<span class="tok-o">*</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">mod</span> <span class="tok-nn">options</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">mod</span> <span class="tok-nn">util</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">mod</span> <span class="tok-nn">reader</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">reader</span>::<span class="tok-n">asciidoc</span>::<span class="tok-n">AsciidocReader</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">reader</span>::<span class="tok-n">json</span>::<span class="tok-n">JsonReader</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">mod</span> <span class="tok-nn">writer</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">writer</span>::<span class="tok-n">html</span>::<span class="tok-n">HtmlWriter</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">writer</span>::<span class="tok-n">json</span>::<span class="tok-n">JsonWriter</span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>ast</code> definiert das allgemeine Zwischenformat für alle Dokumente.</td>
</tr>
</table>
</div>
<div id="public_structs" class="listingblock">
<div class="title">Fehlerbehandlung</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-cp">#[derive(Error, Debug)]</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">enum</span> <span class="tok-nc">AsciidoctrineError</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[error(</span><span class="tok-s">&quot;could not parse input&quot;</span><span class="tok-cp">)]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Parse</span><span class="tok-p">(</span><span class="tok-cp">#[from]</span><span class="tok-w"> </span><span class="tok-n">pest</span>::<span class="tok-n">error</span>::<span class="tok-n">Error</span><span class="tok-o">&lt;</span><span class="tok-n">reader</span>::<span class="tok-n">asciidoc</span>::<span class="tok-n">Rule</span><span class="tok-o">&gt;</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[error(transparent)]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Json</span><span class="tok-p">(</span><span class="tok-cp">#[from]</span><span class="tok-w"> </span><span class="tok-n">serde_json</span>::<span class="tok-n">Error</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[error(transparent)]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Io</span><span class="tok-p">(</span><span class="tok-cp">#[from]</span><span class="tok-w"> </span><span class="tok-n">std</span>::<span class="tok-n">io</span>::<span class="tok-n">Error</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[error(transparent)]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">BufWriter</span><span class="tok-p">(</span><span class="tok-cp">#[from]</span><span class="tok-w"> </span><span class="tok-n">io</span>::<span class="tok-n">IntoInnerError</span><span class="tok-o">&lt;</span><span class="tok-n">io</span>::<span class="tok-n">BufWriter</span><span class="tok-o">&lt;</span><span class="tok-nb">Vec</span><span class="tok-o">&lt;</span><span class="tok-kt">u8</span><span class="tok-o">&gt;&gt;&gt;</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[error(transparent)]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Template</span><span class="tok-p">(</span><span class="tok-cp">#[from]</span><span class="tok-w"> </span><span class="tok-n">tera</span>::<span class="tok-n">Error</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[error(transparent)]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Utf8</span><span class="tok-p">(</span><span class="tok-cp">#[from]</span><span class="tok-w"> </span><span class="tok-n">std</span>::<span class="tok-kt">str</span>::<span class="tok-n">Utf8Error</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">type</span> <span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-n">T</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">std</span>::<span class="tok-n">result</span>::<span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-n">T</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">AsciidoctrineError</span><span class="tok-o">&gt;</span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div id="crate_usages" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-k">extern</span><span class="tok-w"> </span><span class="tok-k">crate</span><span class="tok-w"> </span><span class="tok-n">pest</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-cp">#[macro_use]</span><span class="tok-w"></span>
<span class="tok-k">extern</span><span class="tok-w"> </span><span class="tok-k">crate</span><span class="tok-w"> </span><span class="tok-n">pest_derive</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">std</span>::<span class="tok-n">io</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">structopt</span>::<span class="tok-n">StructOpt</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">thiserror</span>::<span class="tok-n">Error</span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="input-format">Eingabeformate</h3>
<div class="listingblock">
<div class="title">src/reader/mod.rs</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><table class="linenotable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><pre><span></span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">mod</span> <span class="tok-nn">asciidoc</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">mod</span> <span class="tok-nn">json</span><span class="tok-p">;</span><span class="tok-w"></span>
</pre></td></tr></table></code></pre>
</div>
</div>
<div id="asciidoc-syntax" class="paragraph">
<p>Unresolved directive in asciidoctrine.adoc - include::asciidoc-syntax.adoc[]</p>
</div>
<div class="sect3">
<h4 id="_asciidoc">Asciidoc</h4>
<div class="paragraph">
<p>Asciidoc ist ein einfaches Text Markup Format.</p>
</div>
<div class="paragraph">
<p>Wir verwenden <a href="https://pest.rs/">pest</a> um die Syntax zu parsen. Es verwendet <a href="https://pest.rs/book/grammars/peg.html">Parsing Expression Grammars</a> um Daten zu parsen.</p>
</div>
<div class="paragraph">
<p>TODO TOML Eintrag</p>
</div>
<div class="paragraph">
<p>Die grundlegende Syntax definieren wir in einer eigenen Datei welche wir in unserer PEG DSL schreiben.</p>
</div>
<div class="listingblock">
<div class="title">src/reader/asciidoc.pest</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><table class="linenotable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65</pre></div></td><td class="code"><pre><span></span><span class="tok-n">asciidoc</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">_</span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">NEWLINE</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-o">~</span><span class="tok-w"> </span><span class="tok-n">block</span><span class="tok-p">)</span><span class="tok-o">*</span><span class="tok-w">  </span><span class="tok-o">~</span><span class="tok-w"> </span><span class="tok-n">NEWLINE</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-o">~</span><span class="tok-w"> </span><span class="tok-n">EOI</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-n">block</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-o">&lt;&lt;</span><span class="tok-n">block_entries</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-c1">// admonition |</span>
<span class="tok-w">  </span><span class="tok-c1">// example |</span>
<span class="tok-w">  </span><span class="tok-c1">// fenced |</span>
<span class="tok-w">  </span><span class="tok-c1">// listing |</span>
<span class="tok-w">  </span><span class="tok-c1">// literal |</span>
<span class="tok-w">  </span><span class="tok-c1">// open |</span>
<span class="tok-w">  </span><span class="tok-c1">// passthrough |</span>
<span class="tok-w">  </span><span class="tok-c1">// quote |</span>
<span class="tok-w">  </span><span class="tok-c1">// sidebar |</span>
<span class="tok-w">  </span><span class="tok-c1">// source |</span>
<span class="tok-w">  </span><span class="tok-c1">// stem |</span>
<span class="tok-w">  </span><span class="tok-c1">// table |</span>
<span class="tok-w">  </span><span class="tok-c1">// verse |</span>
<span class="tok-w">  </span><span class="tok-n">image_block</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">include_macro</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">delimited_block</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">list</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">attribute_entry_block</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-c1">// Title is nearly the last because it could prevent correct match of others</span>
<span class="tok-w">  </span><span class="tok-n">title_block</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-c1">// paragraph is the last because all others should be checked first</span>
<span class="tok-w">  </span><span class="tok-n">paragraph</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">(</span><span class="tok-o">!</span><span class="tok-n">EOI</span><span class="tok-w"> </span><span class="tok-o">~</span><span class="tok-w"> </span><span class="tok-n">ANY</span><span class="tok-p">)</span><span class="tok-o">+</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-o">&lt;&lt;</span><span class="tok-n">blocks</span><span class="tok-o">|</span><span class="tok-n">join</span><span class="tok-o">=</span><span class="tok-s">&quot;</span><span class="tok-se">\n\n</span><span class="tok-s">&quot;</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"></span>

<span class="tok-c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="tok-c1">// often resused elements</span>

<span class="tok-o">&lt;&lt;</span><span class="tok-n">peg_building_blocks</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"></span>

<span class="tok-c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="tok-c1">// inline elements</span>

<span class="tok-n">inline</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-o">!</span><span class="tok-n">empty_lines</span><span class="tok-w"> </span><span class="tok-o">~</span><span class="tok-w"> </span><span class="tok-o">!</span><span class="tok-n">EOI</span><span class="tok-w"> </span><span class="tok-o">~</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-n">comment</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">link</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">strong</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">emphasized</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">monospaced</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">quoted</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">footnote</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">footnoteref</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">xref</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-n">other_inline</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-o">@</span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-o">!</span><span class="tok-n">empty_lines</span><span class="tok-w"> </span><span class="tok-o">~</span><span class="tok-w"> </span><span class="tok-o">!</span><span class="tok-n">EOI</span><span class="tok-w"> </span><span class="tok-o">~</span><span class="tok-w"> </span><span class="tok-o">!</span><span class="tok-n">inline</span><span class="tok-w"> </span><span class="tok-o">~</span><span class="tok-w"> </span><span class="tok-n">ANY</span><span class="tok-p">)</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-o">&lt;&lt;</span><span class="tok-n">inline_elements</span><span class="tok-o">|</span><span class="tok-n">join</span><span class="tok-o">=</span><span class="tok-s">&quot;</span><span class="tok-se">\n\n</span><span class="tok-s">&quot;</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"></span>

<span class="tok-c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="tok-c1">// generics</span>

<span class="tok-o">&lt;&lt;</span><span class="tok-n">generic_pegs</span><span class="tok-o">|</span><span class="tok-n">join</span><span class="tok-o">=</span><span class="tok-s">&quot;</span><span class="tok-se">\n\n</span><span class="tok-s">&quot;</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"></span>

<span class="tok-c1">////////////////////////////////////////////////////////////////////////////////</span>

<span class="tok-c1">// Implicit whitespace rule</span>
<span class="tok-n">WHITESPACE</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">_</span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-s">&quot; &quot;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s">&quot;</span><span class="tok-se">\t</span><span class="tok-s">&quot;</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"></span>
</pre></td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Damit können wir die Syntax in einer relativ formalen Sprache definieren welche das parsen erleichtert. Diesem, noch eher groben AST, weisen wir dann eine semantische Bedeutung zu. Den Code dazu definieren wir in einem eigenen Rust Modul mit dem Namen <code>asciidoc.rs</code>.</p>
</div>
<div class="listingblock">
<div class="title">src/reader/asciidoc.rs</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><table class="linenotable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255</pre></div></td><td class="code"><pre><span></span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-n">ast</span>::<span class="tok-o">*</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-n">options</span>::<span class="tok-n">Opts</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-n">util</span>::<span class="tok-p">{</span><span class="tok-n">Env</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">Environment</span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-n">reader</span>::<span class="tok-o">*</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-nb">Result</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">pest</span>::<span class="tok-n">iterators</span>::<span class="tok-n">Pair</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">pest</span>::<span class="tok-n">Parser</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">struct</span> <span class="tok-nc">AsciidocReader</span><span class="tok-w"> </span><span class="tok-p">{}</span><span class="tok-w"></span>

<span class="tok-k">impl</span><span class="tok-w"> </span><span class="tok-n">AsciidocReader</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">fn</span> <span class="tok-nf">new</span><span class="tok-p">()</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">Self</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">AsciidocReader</span><span class="tok-w"> </span><span class="tok-p">{}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">impl</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-n">Reader</span><span class="tok-w"> </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">AsciidocReader</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">fn</span> <span class="tok-nf">parse</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">input</span>: <span class="tok-kp">&amp;</span><span class="tok-na">&#39;a</span><span class="tok-w"> </span><span class="tok-kt">str</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">args</span>: <span class="tok-kp">&amp;</span><span class="tok-nc">Opts</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">env</span>: <span class="tok-kp">&amp;</span><span class="tok-nc">mut</span><span class="tok-w"> </span><span class="tok-n">Env</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-n">AST</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">ast</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">AsciidocParser</span>::<span class="tok-n">parse</span><span class="tok-p">(</span><span class="tok-n">Rule</span>::<span class="tok-n">asciidoc</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">    </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">attributes</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-nb">Vec</span>::<span class="tok-n">new</span><span class="tok-p">();</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">args</span><span class="tok-p">.</span><span class="tok-n">input</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">path</span><span class="tok-p">.</span><span class="tok-n">to_str</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">key</span>: <span class="tok-s">&quot;source&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-nb">String</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">});</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">    </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">elements</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-nb">Vec</span>::<span class="tok-n">new</span><span class="tok-p">();</span><span class="tok-w"></span>

<span class="tok-w">    </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">ast</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-c1">//println!(&quot;{:#?}&quot;, element); // TODO entfernen</span>
<span class="tok-w">      </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_element</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">env</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">elements</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">    </span><span class="tok-nb">Ok</span><span class="tok-p">(</span><span class="tok-n">AST</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">content</span>: <span class="tok-nc">input</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">elements</span>: <span class="tok-nc">elements</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">attributes</span>: <span class="tok-nc">attributes</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">})</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-cp">#[derive(Parser, Debug, Copy, Clone)]</span><span class="tok-w"></span>
<span class="tok-cp">#[grammar = </span><span class="tok-s">&quot;reader/asciidoc.pest&quot;</span><span class="tok-cp">]</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">struct</span> <span class="tok-nc">AsciidocParser</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-o">&lt;&lt;</span><span class="tok-n">asciidoc_parser_functions</span><span class="tok-o">|</span><span class="tok-n">join</span><span class="tok-o">=</span><span class="tok-s">&quot;</span><span class="tok-se">\n\n</span><span class="tok-s">&quot;</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"></span>

<span class="tok-k">fn</span> <span class="tok-nf">process_delimited_inner</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">element</span>: <span class="tok-nc">Pair</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">asciidoc</span>::<span class="tok-n">Rule</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">base</span>: <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">delimited_inner</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">key</span>: <span class="tok-s">&quot;content&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"> </span><span class="tok-c1">// TODO</span>
<span class="tok-w">          </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-n">Ref</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">});</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">base</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">fn</span> <span class="tok-nf">concat_elements</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">element</span>: <span class="tok-nc">Pair</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">asciidoc</span>::<span class="tok-n">Rule</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">filter</span>: <span class="tok-nc">asciidoc</span>::<span class="tok-n">Rule</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">join</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nb">Option</span><span class="tok-o">&lt;</span><span class="tok-nb">String</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">elements</span>: <span class="tok-nb">Vec</span><span class="tok-o">&lt;</span><span class="tok-n">_</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">.</span><span class="tok-n">filter</span><span class="tok-p">(</span><span class="tok-o">|</span><span class="tok-n">e</span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">e</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-o">==</span><span class="tok-w"> </span><span class="tok-n">filter</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">.</span><span class="tok-n">map</span><span class="tok-p">(</span><span class="tok-o">|</span><span class="tok-n">e</span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">e</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">())</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">.</span><span class="tok-n">collect</span><span class="tok-p">();</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">elements</span><span class="tok-p">.</span><span class="tok-n">len</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-mi">0</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">elements</span><span class="tok-p">.</span><span class="tok-n">join</span><span class="tok-p">(</span><span class="tok-n">join</span><span class="tok-p">))</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-k">else</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nb">None</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">fn</span> <span class="tok-nf">process_xref</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">element</span>: <span class="tok-nc">Pair</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">asciidoc</span>::<span class="tok-n">Rule</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">base</span>: <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">XRef</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">clone</span><span class="tok-p">().</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">identifier</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">key</span>: <span class="tok-s">&quot;id&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-n">Ref</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">});</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">word</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">content</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">concat_elements</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">Rule</span>::<span class="tok-n">word</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot; &quot;</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">key</span>: <span class="tok-s">&quot;content&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-nb">String</span><span class="tok-p">(</span><span class="tok-n">content</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">});</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">};</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-n">base</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">fn</span> <span class="tok-nf">process_inline</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">element</span>: <span class="tok-nc">Pair</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">asciidoc</span>::<span class="tok-n">Rule</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">base</span>: <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">link</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_link</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">xref</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_xref</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">monospaced</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Styled</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">key</span>: <span class="tok-s">&quot;style&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-n">Ref</span><span class="tok-p">(</span><span class="tok-s">&quot;monospaced&quot;</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">});</span><span class="tok-w"></span>

<span class="tok-w">        </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">content</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">concat_elements</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">Rule</span>::<span class="tok-n">linechar</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;&quot;</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">key</span>: <span class="tok-s">&quot;content&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-nb">String</span><span class="tok-p">(</span><span class="tok-n">content</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">});</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">strong</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Styled</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">key</span>: <span class="tok-s">&quot;style&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-n">Ref</span><span class="tok-p">(</span><span class="tok-s">&quot;strong&quot;</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">});</span><span class="tok-w"></span>

<span class="tok-w">        </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">content</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">concat_elements</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">Rule</span>::<span class="tok-n">linechar</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;&quot;</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">key</span>: <span class="tok-s">&quot;content&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-nb">String</span><span class="tok-p">(</span><span class="tok-n">content</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">});</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Error</span><span class="tok-p">(</span><span class="tok-s">&quot;Not implemented&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">());</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">base</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">fn</span> <span class="tok-nf">set_span</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-n">element</span>: <span class="tok-kp">&amp;</span><span class="tok-nc">Pair</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">asciidoc</span>::<span class="tok-n">Rule</span><span class="tok-o">&gt;</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">start_line</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">start_col</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_span</span><span class="tok-p">().</span><span class="tok-n">start_pos</span><span class="tok-p">().</span><span class="tok-n">line_col</span><span class="tok-p">();</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">end_line</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">end_col</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_span</span><span class="tok-p">().</span><span class="tok-n">end_pos</span><span class="tok-p">().</span><span class="tok-n">line_col</span><span class="tok-p">();</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-n">ElementSpan</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">element</span>: <span class="tok-nc">Element</span>::<span class="tok-n">Error</span><span class="tok-p">(</span><span class="tok-s">&quot;Root&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">source</span>: <span class="tok-nb">None</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-c1">// TODO</span>
<span class="tok-w">    </span><span class="tok-n">content</span>: <span class="tok-nc">element</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">children</span>: <span class="tok-nb">Vec</span>::<span class="tok-n">new</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">attributes</span>: <span class="tok-nb">Vec</span>::<span class="tok-n">new</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">positional_attributes</span>: <span class="tok-nb">Vec</span>::<span class="tok-n">new</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">start</span>: <span class="tok-nc">element</span><span class="tok-p">.</span><span class="tok-n">as_span</span><span class="tok-p">().</span><span class="tok-n">start</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">end</span>: <span class="tok-nc">element</span><span class="tok-p">.</span><span class="tok-n">as_span</span><span class="tok-p">().</span><span class="tok-n">end</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">start_line</span>: <span class="tok-nc">start_line</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">start_col</span>: <span class="tok-nc">start_col</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">end_line</span>: <span class="tok-nc">end_line</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">end_col</span>: <span class="tok-nc">end_col</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">fn</span> <span class="tok-nf">process_element</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-n">element</span>: <span class="tok-nc">Pair</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">asciidoc</span>::<span class="tok-n">Rule</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">env</span>: <span class="tok-kp">&amp;</span><span class="tok-nc">mut</span><span class="tok-w"> </span><span class="tok-n">Env</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nb">Option</span><span class="tok-o">&lt;</span><span class="tok-n">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">set_span</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">element</span><span class="tok-p">);</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">&lt;&lt;</span><span class="tok-n">asciidoc_element_rules</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Rule</span>::<span class="tok-n">block</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">e</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_element</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">env</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">e</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">base</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Rule</span>::<span class="tok-n">delimited_block</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">Rule</span>::<span class="tok-n">anchor</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_anchor</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">Rule</span>::<span class="tok-n">attribute_list</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_attribute_list</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">Rule</span>::<span class="tok-n">blocktitle</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_blocktitle</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-c1">// TODO wir müssen die anderen delimitets verarbeiten</span>
<span class="tok-w">          </span><span class="tok-n">Rule</span>::<span class="tok-n">delimited_source</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">TypedBlock</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-n">kind</span>: <span class="tok-nc">BlockType</span>::<span class="tok-n">Listing</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_delimited_inner</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">Rule</span>::<span class="tok-n">delimited_literal</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">TypedBlock</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-n">kind</span>: <span class="tok-nc">BlockType</span>::<span class="tok-n">Listing</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_delimited_inner</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">Rule</span>::<span class="tok-n">delimited_comment</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">TypedBlock</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-n">kind</span>: <span class="tok-nc">BlockType</span>::<span class="tok-n">Comment</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_delimited_inner</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-c1">// We just take the attributes at the beginning</span>
<span class="tok-w">          </span><span class="tok-c1">// of the element.</span>
<span class="tok-w">          </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-k">break</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c1">// TODO improve matching</span>
<span class="tok-w">        </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">base</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Rule</span>::<span class="tok-n">paragraph</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">process_paragraph</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">)),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Rule</span>::<span class="tok-n">list_paragraph</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">process_paragraph</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">)),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Rule</span>::<span class="tok-n">inline</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">process_inline</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">)),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Rule</span>::<span class="tok-n">other_list_inline</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Text</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">base</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Rule</span>::<span class="tok-n">continuation</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-nb">None</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Rule</span>::<span class="tok-n">EOI</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-nb">None</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Error</span><span class="tok-p">(</span><span class="tok-s">&quot;Not implemented&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">());</span><span class="tok-w"> </span><span class="tok-c1">// TODO</span>
<span class="tok-w">      </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">base</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">};</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-n">element</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
</pre></td></tr></table></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_grundlegender_aufbau_eines_asciidoc_dokuments">Grundlegender Aufbau eines Asciidoc Dokuments</h5>
<div class="paragraph">
<p>TODO</p>
</div>
<div class="sect5">
<h6 id="_wichtige_konzepte">Wichtige Konzepte</h6>
<div class="paragraph">
<p>TODO Attribut Listen etc</p>
</div>
<div class="sect6">
<h7 id="_elemente">Elemente</h7>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect6">
<h7 id="_anker">Anker</h7>
<div class="paragraph">
<p>TODO</p>
</div>
<div id="peg_building_blocks" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="pest"><span></span>anchor = { inline_anchor ~ NEWLINE }
inline_anchor = { &quot;[[&quot; ~ (identifier | path) ~ &quot;]]&quot; }</code></pre>
</div>
</div>
<div id="asciidoc_parser_functions" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-k">fn</span> <span class="tok-nf">process_anchor</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">element</span>: <span class="tok-nc">Pair</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">asciidoc</span>::<span class="tok-n">Rule</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">base</span>: <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">inline_anchor</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">Rule</span>::<span class="tok-n">identifier</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">                </span><span class="tok-n">key</span>: <span class="tok-s">&quot;anchor&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">                </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-n">Ref</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-p">});</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-c1">// TODO Fehler abfangen und anzeigen</span>
<span class="tok-w">            </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">base</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="_attribute">Attribute</h7>
<div class="paragraph">
<p>TODO</p>
</div>
<div id="peg_building_blocks" class="listingblock">
<div class="title">Element Attribute</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="pest"><span></span>attribute_list = { inline_attribute_list ~ NEWLINE }

inline_attribute_list = {
  &quot;[&quot; ~ (attribute ~ (&quot;,&quot; ~ attribute)* )? ~ &quot;]&quot;
}

attribute = { named_attribute | attribute_value }
named_attribute = { identifier ~ &quot;=&quot; ~ attribute_value }
attribute_value = {
  (&quot;\&quot;&quot; ~ inner_attribute_value ~ &quot;\&quot;&quot;) |
  ( (!&quot;,&quot; ~ !&quot;]&quot; ~ ANY)+ )
}
inner_attribute_value = { ( &quot;\\\&quot;&quot; | (!&quot;\&quot;&quot; ~ ANY))* }</code></pre>
</div>
</div>
<div id="asciidoc_parser_functions" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-k">fn</span> <span class="tok-nf">process_inline_attribute_list</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">element</span>: <span class="tok-nc">Pair</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">asciidoc</span>::<span class="tok-n">Rule</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">base</span>: <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">attribute</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">Rule</span>::<span class="tok-n">attribute_value</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-c1">// TODO Wir müssen unterschiedlich damit umgehen, ob ein oder mehrere</span>
<span class="tok-w">              </span><span class="tok-c1">// identifier existieren</span>
<span class="tok-w">              </span><span class="tok-n">base</span><span class="tok-w"></span>
<span class="tok-w">                </span><span class="tok-p">.</span><span class="tok-n">positional_attributes</span><span class="tok-w"></span>
<span class="tok-w">                </span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">AttributeValue</span>::<span class="tok-n">Ref</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">()));</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">Rule</span>::<span class="tok-n">named_attribute</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">key</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-nb">None</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">value</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-nb">None</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">              </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">                </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">                  </span><span class="tok-n">Rule</span>::<span class="tok-n">identifier</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-n">key</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">                  </span><span class="tok-n">Rule</span>::<span class="tok-n">attribute_value</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">                    </span><span class="tok-n">value</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">().</span><span class="tok-n">concat</span><span class="tok-p">());</span><span class="tok-w"></span>
<span class="tok-w">                  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">                  </span><span class="tok-c1">// TODO Fehler abfangen und anzeigen</span>
<span class="tok-w">                  </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">                </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">              </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">                </span><span class="tok-n">key</span>: <span class="tok-nc">key</span><span class="tok-p">.</span><span class="tok-n">unwrap</span><span class="tok-p">().</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">                </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-nb">String</span><span class="tok-p">(</span><span class="tok-n">value</span><span class="tok-p">.</span><span class="tok-n">unwrap</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-p">});</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-c1">// TODO Fehler abfangen und anzeigen</span>
<span class="tok-w">            </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-c1">// TODO Fehler abfangen und anzeigen</span>
<span class="tok-w">      </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">base</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">fn</span> <span class="tok-nf">process_attribute_list</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">element</span>: <span class="tok-nc">Pair</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">asciidoc</span>::<span class="tok-n">Rule</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">base</span>: <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">inline_attribute_list</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_inline_attribute_list</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">base</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="_blocktitel_elementtitel">Blocktitel (Elementtitel)</h7>
<div class="paragraph">
<p>TODO</p>
</div>
<div id="peg_building_blocks" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="pest"><span></span>blocktitle = { &quot;.&quot; ~ !&quot;.&quot; ~ line ~ NEWLINE }</code></pre>
</div>
</div>
<div id="asciidoc_parser_functions" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-k">fn</span> <span class="tok-nf">process_blocktitle</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">element</span>: <span class="tok-nc">Pair</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">asciidoc</span>::<span class="tok-n">Rule</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">base</span>: <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">line</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">key</span>: <span class="tok-s">&quot;title&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"> </span><span class="tok-c1">// TODO</span>
<span class="tok-w">          </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-n">Ref</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">});</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">base</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_document_header">Document Header</h5>
<div class="paragraph">
<p>Viele Dokumente beginnen mit einem Header. Es ist die Hauptüberschrift
und kann optional noch einige Metadaten enthalten welche sich auf das
ganze Doument beziehen.</p>
</div>
<div id="block_entries" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="pest"><span></span>header |</code></pre>
</div>
</div>
<div id="blocks" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="pest"><span></span>header = {
  title ~
  (NEWLINE ~ author_info)? ~
  (NEWLINE ~ revision_info)? ~
  ( (NEWLINE ~ attribute_entry) |
    (NEWLINE ~ &quot;//&quot; ~ (!EOI ~ !NEWLINE ~ ANY)* ~ &amp;NEWLINE ) // TODO Comment entfernen
  )*
  ~ &amp;NEWLINE{2,}
}</code></pre>
</div>
</div>
<div id="blocks" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="pest"><span></span>revision_info = { identifier } // TODO

author_info = { word+ ~ email? ~ &amp;NEWLINE }

email = { &quot;&lt;&quot; ~ (LETTER | &quot;.&quot; )+ ~ &quot;@&quot; ~ (LETTER | &quot;.&quot; )+ ~ &quot;&gt;&quot; }</code></pre>
</div>
</div>
<div id="asciidoc_element_rules" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-n">Rule</span>::<span class="tok-n">header</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">title</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">e</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_title</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">clone</span><span class="tok-p">())</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">e</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-c1">// We just take the attributes at the beginning</span>
<span class="tok-w">      </span><span class="tok-c1">// of the element.</span>
<span class="tok-w">      </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">break</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c1">// TODO improve matching</span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-c1">// TODO</span>
<span class="tok-w">  </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">base</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_überschriften">Überschriften</h5>
<div class="paragraph">
<p>Überschriften werden verwendet um das Dokument in Unterthemen zu gruppieren.</p>
</div>
<div id="blocks" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="pest"><span></span>title_block = { anchor* ~ title }
title = {
  (line ~ NEWLINE ~ setext_title_style ) |
  (atx_title_style ~ line)
}
setext_title_style = { (&quot;=&quot;{4,} | &quot;-&quot;{4,} | &quot;~&quot;{4,} | &quot;^&quot;{4,} ) ~ &amp;NEWLINE }
atx_title_style = { &quot;=&quot;+ }</code></pre>
</div>
</div>
<div id="asciidoc_element_rules" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-n">Rule</span>::<span class="tok-n">title</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-n">process_title</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-n">Rule</span>::<span class="tok-n">title_block</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">title</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">e</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_title</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">clone</span><span class="tok-p">())</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">e</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">anchor</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_anchor</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-c1">// We just take the attributes at the beginning</span>
<span class="tok-w">      </span><span class="tok-c1">// of the element.</span>
<span class="tok-w">      </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">break</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c1">// TODO improve matching</span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">base</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div id="asciidoc_parser_functions" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-k">fn</span> <span class="tok-nf">process_title</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">element</span>: <span class="tok-nc">Pair</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">asciidoc</span>::<span class="tok-n">Rule</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">base</span>: <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nb">Option</span><span class="tok-o">&lt;</span><span class="tok-n">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Rule</span>::<span class="tok-n">title</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">Rule</span>::<span class="tok-n">atx_title_style</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Title</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-n">level</span>: <span class="tok-nc">subelement</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">().</span><span class="tok-n">trim</span><span class="tok-p">().</span><span class="tok-n">len</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-k">as</span><span class="tok-w"> </span><span class="tok-kt">u32</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">Rule</span>::<span class="tok-n">setext_title_style</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">ch</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">().</span><span class="tok-n">chars</span><span class="tok-p">().</span><span class="tok-n">next</span><span class="tok-p">().</span><span class="tok-n">unwrap</span><span class="tok-p">();</span><span class="tok-w"> </span><span class="tok-c1">// TODO Check None?</span>
<span class="tok-w">            </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">level</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">            </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">ch</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-sc">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">                </span><span class="tok-n">level</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mi">1</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">                </span><span class="tok-n">level</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mi">2</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-sc">&#39;~&#39;</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">                </span><span class="tok-n">level</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mi">3</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-sc">&#39;^&#39;</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">                </span><span class="tok-n">level</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mi">4</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">                </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Error</span><span class="tok-p">(</span><span class="tok-s">&quot;Unsupported title formatting&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">());</span><span class="tok-w"></span>
<span class="tok-w">                </span><span class="tok-k">break</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Title</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-n">level</span>: <span class="tok-nc">level</span><span class="tok-w"> </span><span class="tok-k">as</span><span class="tok-w"> </span><span class="tok-kt">u32</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">Rule</span>::<span class="tok-n">line</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-n">key</span>: <span class="tok-s">&quot;name&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-n">Ref</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-p">});</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-c1">// We just take the attributes at the beginning</span>
<span class="tok-w">          </span><span class="tok-c1">// of the element.</span>
<span class="tok-w">          </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-k">break</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-c1">// TODO Error</span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c1">// TODO improve matching</span>
<span class="tok-w">        </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Error</span><span class="tok-p">(</span><span class="tok-s">&quot;Not implemented&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">());</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c1">// TODO</span>
<span class="tok-w">  </span><span class="tok-p">};</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">base</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_absätze">Absätze</h5>
<div class="paragraph">
<p>TODO</p>
</div>
<div id="blocks" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="pest"><span></span>paragraph = ${ (inline | other_inline)+ }</code></pre>
</div>
</div>
<div id="asciidoc_parser_functions" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-k">fn</span> <span class="tok-nf">process_paragraph</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">element</span>: <span class="tok-nc">Pair</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">asciidoc</span>::<span class="tok-n">Rule</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">base</span>: <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Paragraph</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">sub</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">set_span</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">subelement</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">other_inline</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">sub</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Text</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-c1">// TODO Newlines entfernen? Als Attribut?</span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">other_list_inline</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">sub</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Text</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">inline</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">sub</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_inline</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">sub</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">sub</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Error</span><span class="tok-p">(</span><span class="tok-s">&quot;Not implemented!&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">());</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">children</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">sub</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-n">base</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_listen">Listen</h5>
<div id="blocks" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="pest"><span></span>list = { bullet_list | numbered_list | labeled_list }

list_element = ${
  (
    list_paragraph |
    (continuation ~ delimited_block)
  )+
}
list_paragraph = ${ (inline | other_list_inline)+ }
other_list_inline = @{ (!empty_lines ~ !EOI ~ !inline ~ !(NEWLINE ~ bullet) ~ !(continuation ~ delimited_block) ~ ANY)+ }

bullet = { (&quot;*&quot;+ | &quot;-&quot;+) }
bullet_list_element = { bullet ~ list_element ~ (NEWLINE | EOI) }
bullet_list = { bullet_list_element+ }

numbered_list = { &quot;numbered_list&quot; } // TODO

label_bullet = { (!&quot;::&quot; ~ linechar) ~ &quot;::&quot; }
labeled_list = { (label_bullet ~ list_element)+ }</code></pre>
</div>
</div>
<div id="asciidoc_element_rules" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-n">Rule</span>::<span class="tok-n">list</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">e</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_element</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">env</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">e</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">base</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_unnummerierte_listen">Unnummerierte Listen</h6>
<div class="paragraph">
<p>TODO</p>
</div>
<div id="asciidoc_element_rules" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-n">Rule</span>::<span class="tok-n">bullet_list</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">List</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">e</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_element</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">env</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">children</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">e</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">base</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-n">Rule</span>::<span class="tok-n">bullet_list_element</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">bullet</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">ListItem</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">().</span><span class="tok-n">trim</span><span class="tok-p">().</span><span class="tok-n">len</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-k">as</span><span class="tok-w"> </span><span class="tok-kt">u32</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">list_element</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">subelement</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">e</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_element</span><span class="tok-p">(</span><span class="tok-n">subelement</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">env</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">children</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">e</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">e</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">set_span</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">subelement</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">e</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Error</span><span class="tok-p">(</span><span class="tok-s">&quot;Not implemented&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">());</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">children</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">e</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">base</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_nummerierte_listen">Nummerierte Listen</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect5">
<h6 id="_abhacklisten">Abhacklisten</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect5">
<h6 id="_benannte_listen_description_lists">Benannte Listen (Description Lists)</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_links">Links</h5>
<div class="paragraph">
<p>TODO</p>
</div>
<div id="inline_elements" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="pest"><span></span>link = ${ url ~ inline_attribute_list }
url = ${proto ~ &quot;://&quot; ~ path}
proto = ${ (&quot;http&quot; ~ &quot;s&quot;?) |
           &quot;mailto&quot; |
           &quot;git&quot;
         }</code></pre>
</div>
</div>
<div id="asciidoc_parser_functions" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-k">fn</span> <span class="tok-nf">process_link</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">element</span>: <span class="tok-nc">Pair</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">asciidoc</span>::<span class="tok-n">Rule</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">base</span>: <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Link</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">url</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">key</span>: <span class="tok-s">&quot;url&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-n">Ref</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">});</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">().</span><span class="tok-n">next</span><span class="tok-p">().</span><span class="tok-n">unwrap</span><span class="tok-p">();</span><span class="tok-w"> </span><span class="tok-c1">// TODO Fehler möglich?</span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">key</span>: <span class="tok-s">&quot;protocol&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-n">Ref</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">});</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">inline_attribute_list</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_inline_attribute_list</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">sub</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">set_span</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">element</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">sub</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Error</span><span class="tok-p">(</span><span class="tok-s">&quot;Not implemented&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">());</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">children</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">sub</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">base</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_querverweise">Querverweise</h5>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect4">
<h5 id="_fußnoten">Fußnoten</h5>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect4">
<h5 id="_bilder">Bilder</h5>
<div class="paragraph">
<p>Um Bilder einzubinden verwenden wir die übliche Syntax für Macros mit dem Schlüsselwort <em>image</em>.</p>
</div>
<div id="blocks" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="pest"><span></span>image_block = { anchor* ~ image }
image = { &quot;image::&quot; ~ (url | path) ~ inline_attribute_list }</code></pre>
</div>
</div>
<div id="asciidoc_element_rules" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-n">Rule</span>::<span class="tok-n">image_block</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">process_image</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">env</span><span class="tok-p">)),</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div id="asciidoc_parser_functions" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-k">fn</span> <span class="tok-nf">process_image</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">element</span>: <span class="tok-nc">Pair</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">asciidoc</span>::<span class="tok-n">Rule</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">base</span>: <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">env</span>: <span class="tok-kp">&amp;</span><span class="tok-nc">mut</span><span class="tok-w"> </span><span class="tok-n">Env</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">Image</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">().</span><span class="tok-n">flatten</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_rule</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">url</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">key</span>: <span class="tok-s">&quot;path&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-n">Ref</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">});</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">path</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">key</span>: <span class="tok-s">&quot;path&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-n">Ref</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">});</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Rule</span>::<span class="tok-n">inline_attribute_list</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">base</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">process_inline_attribute_list</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-c1">// TODO Prüfen ob eine inline Anweisung vorhanden ist und</span>
<span class="tok-w">  </span><span class="tok-c1">// falls ja, die Datei einlesen</span>
<span class="tok-w">  </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">value</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">get_attribute</span><span class="tok-p">(</span><span class="tok-s">&quot;opts&quot;</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">value</span><span class="tok-w"> </span><span class="tok-o">==</span><span class="tok-w"> </span><span class="tok-s">&quot;inline&quot;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-c1">// TODO Die Datei einlesen</span>
<span class="tok-w">      </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">get_attribute</span><span class="tok-p">(</span><span class="tok-s">&quot;path&quot;</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">env</span><span class="tok-p">.</span><span class="tok-n">read_to_string</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-nb">Ok</span><span class="tok-p">(</span><span class="tok-n">content</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">base</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">push</span><span class="tok-p">(</span><span class="tok-n">Attribute</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-n">key</span>: <span class="tok-s">&quot;content&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">              </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span>::<span class="tok-nb">String</span><span class="tok-p">(</span><span class="tok-n">content</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-p">});</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-nb">Err</span><span class="tok-p">(</span><span class="tok-n">e</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">error</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-s">&quot;couldn&#39;t read content of image file {} ({})&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">path</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">e</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-k">else</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">error</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-s">&quot;There was no path of inline image defined&quot;</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-n">base</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tabellen">Tabellen</h5>
<div class="paragraph">
<p>TODO</p>
</div>
<div id="blocks" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="pest"><span></span>attribute_entry = { &quot;:&quot; ~ identifier ~ &quot;:&quot; ~ identifier? ~ &amp;NEWLINE }
attribute_entry_block = { attribute_entry ~ NEWLINE }

delimited_block = {
  (anchor | attribute_list | blocktitle)* ~
  (
    //delimited_admonition |
    delimited_comment |
    //delimited_example |
    //delimited_fenced |
    //delimited_listing |
    delimited_literal |
    //delimited_open |
    //delimited_passthrough |
    //delimited_quote |
    //delimited_sidebar |
    delimited_source |
    //delimited_stem |
    //delimited_table |
    delimited_verse
  )
}

delimited_inner = @{ (!(NEWLINE ~ PEEK) ~ ANY)* }

delimited_comment = {
  PUSH(&quot;/&quot;{4,} ~ NEWLINE) ~
  delimited_inner ~
  NEWLINE ~ POP
}

delimited_literal = {
  PUSH(&quot;.&quot;{4,} ~ NEWLINE) ~
  delimited_inner ~
  NEWLINE ~ POP
}

delimited_source = {
  PUSH(&quot;-&quot;{4,} ~ NEWLINE) ~
  delimited_inner ~
  NEWLINE ~ POP
}

delimited_verse = { &quot;verse&quot; } // TODO

include_macro = { &quot;include::&quot; ~ path ~ inline_attribute_list }</code></pre>
</div>
</div>
<div id="inline_elements" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="pest"><span></span>footnote = { &quot;footnote:&quot; ~ inline_attribute_list }
footnoteref = { &quot;footnoteref:&quot; ~ inline_attribute_list }
xref = !{ &quot;&lt;&lt;&quot; ~ identifier ~ (NEWLINE? ~ &quot;,&quot; ~ NEWLINE? ~ word+)? ~ &quot;&gt;&gt;&quot; }

strong = ${ &quot;*&quot; ~ (!&quot;*&quot; ~ linechar)+ ~ &quot;*&quot; }
emphasized = @{ &quot;_&quot; ~ (!&quot;_&quot; ~ linechar)+ ~ &quot;_&quot; }
monospaced = ${ (&quot;+&quot; ~ (!&quot;+&quot; ~ linechar)+ ~ &quot;+&quot;) | (&quot;`&quot; ~ (!&quot;`&quot; ~ linechar)+ ~ &quot;`&quot;) }
quoted = @{ inline_attribute_list ~ &quot;#&quot; ~ (!&quot;#&quot; ~ linechar)+ ~ &quot;#&quot; }

// TODO Damit werden keine Kommentare zu Beginn eines Paragraphen angezeigt
comment = { NEWLINE ~ &quot;//&quot; ~ (!NEWLINE ~ ANY)* ~ &amp;NEWLINE }

continuation = { NEWLINE ~ &quot;+&quot; ~ NEWLINE }</code></pre>
</div>
</div>
<div id="generic_pegs" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="pest"><span></span>// TODO Should all unicode letters be matched? Instead of just ascii?
identifier = @{ (ASCII_ALPHANUMERIC | &quot;_&quot;) ~ (ASCII_ALPHANUMERIC | &quot;_&quot; | &quot;-&quot; | &quot;.&quot;)* }

word = @{ (LETTER | NUMBER | &quot;_&quot; | &quot;-&quot;)+ }
path = @{ (LETTER | NUMBER | &quot;_&quot; | &quot;-&quot; | &quot;.&quot; | &quot;/&quot; | &quot;~&quot; )+ }

linechar = { (!NEWLINE ~ ANY) }

line = { linechar+ ~ ( &amp;NEWLINE | &amp;EOI) }

empty_lines = _{ NEWLINE{2, } | (NEWLINE ~ EOI) }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Unresolved directive in asciidoctrine.adoc - include::src/json-syntax.adoc[]</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_json">Json</h4>
<div class="listingblock">
<div class="title">src/reader/json.rs</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><table class="linenotable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><pre><span></span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-n">ast</span>::<span class="tok-o">*</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-n">options</span>::<span class="tok-n">Opts</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-n">util</span>::<span class="tok-p">{</span><span class="tok-n">Env</span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-nb">Result</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">struct</span> <span class="tok-nc">JsonReader</span><span class="tok-w"> </span><span class="tok-p">{}</span><span class="tok-w"></span>

<span class="tok-k">impl</span><span class="tok-w"> </span><span class="tok-n">JsonReader</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">fn</span> <span class="tok-nf">new</span><span class="tok-p">()</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">Self</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">JsonReader</span><span class="tok-w"> </span><span class="tok-p">{}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">impl</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-n">Reader</span><span class="tok-w"> </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">JsonReader</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">fn</span> <span class="tok-nf">parse</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">input</span>: <span class="tok-kp">&amp;</span><span class="tok-na">&#39;a</span><span class="tok-w"> </span><span class="tok-kt">str</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">_args</span>: <span class="tok-kp">&amp;</span><span class="tok-nc">Opts</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">_env</span>: <span class="tok-kp">&amp;</span><span class="tok-nc">mut</span><span class="tok-w"> </span><span class="tok-n">Env</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-n">AST</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">ast</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">serde_json</span>::<span class="tok-n">from_str</span><span class="tok-p">(</span><span class="tok-n">input</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">    </span><span class="tok-nb">Ok</span><span class="tok-p">(</span><span class="tok-n">ast</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
</pre></td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="output-format">Ausgabeformate</h3>
<div class="paragraph">
<p>Der ganze Sinn des Programmes besteht darin, aus einer einzigen Datenquelle
verschiedene Ausgabedateien zu erzeugen. Diese können noch eigenen
Vorstellungen oder Vorgaben formatiert und abgelegt werden. <code>asciidoctrine</code>
unterstützt verschiedene Ausgabeformate, die in den folgenden Abschnitten
beschrieben werden (sowie wie man Formatierungsanpassungen vornehmen kann)</p>
</div>
<div class="listingblock">
<div class="title">src/writer/mod.rs</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><table class="linenotable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><pre><span></span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">mod</span> <span class="tok-nn">html</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">mod</span> <span class="tok-nn">json</span><span class="tok-p">;</span><span class="tok-w"></span>
</pre></td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Unresolved directive in asciidoctrine.adoc - include::src/output/html5.adoc[]</p>
</div>
<div class="sect3">
<h4 id="html5">Html5</h4>
<div class="listingblock">
<div class="title">src/writer/html.rs</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><table class="linenotable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108</pre></div></td><td class="code"><pre><span></span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-n">ast</span>::<span class="tok-o">*</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-n">util</span>::<span class="tok-n">Environment</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-p">{</span><span class="tok-n">options</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nb">Result</span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">std</span>::<span class="tok-n">io</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">tera</span>::<span class="tok-p">{</span><span class="tok-n">Context</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">Tera</span><span class="tok-p">};</span><span class="tok-w"></span>

<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">struct</span> <span class="tok-nc">HtmlWriter</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">io</span>: <span class="tok-nc">crate</span>::<span class="tok-n">util</span>::<span class="tok-n">Env</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">impl</span><span class="tok-w"> </span><span class="tok-n">HtmlWriter</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">fn</span> <span class="tok-nf">new</span><span class="tok-p">()</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">Self</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">HtmlWriter</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">io</span>: <span class="tok-nc">crate</span>::<span class="tok-n">util</span>::<span class="tok-n">Env</span>::<span class="tok-n">Io</span><span class="tok-p">(</span><span class="tok-k">crate</span>::<span class="tok-n">util</span>::<span class="tok-n">Io</span>::<span class="tok-n">new</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">impl</span><span class="tok-o">&lt;</span><span class="tok-n">T</span>: <span class="tok-nc">io</span>::<span class="tok-n">Write</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-n">Writer</span><span class="tok-o">&lt;</span><span class="tok-n">T</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">HtmlWriter</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">fn</span> <span class="tok-nf">write</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">ast</span>: <span class="tok-nc">AST</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">args</span>: <span class="tok-kp">&amp;</span><span class="tok-nc">options</span>::<span class="tok-n">Opts</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">out</span>: <span class="tok-nc">T</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-p">()</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">buf</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">io</span>::<span class="tok-n">BufWriter</span>::<span class="tok-n">new</span><span class="tok-p">(</span><span class="tok-nb">Vec</span>::<span class="tok-n">new</span><span class="tok-p">());</span><span class="tok-w"></span>

<span class="tok-w">    </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">ast</span><span class="tok-p">.</span><span class="tok-n">elements</span><span class="tok-p">.</span><span class="tok-n">iter</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">write_html</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">buf</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">bytes</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">buf</span><span class="tok-p">.</span><span class="tok-n">into_inner</span><span class="tok-p">()</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">    </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">context</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Context</span>::<span class="tok-n">new</span><span class="tok-p">();</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">context</span><span class="tok-p">.</span><span class="tok-n">insert</span><span class="tok-p">(</span><span class="tok-s">&quot;lang&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">context</span><span class="tok-p">.</span><span class="tok-n">insert</span><span class="tok-p">(</span><span class="tok-s">&quot;doctitle&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;&quot;</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">args</span><span class="tok-p">.</span><span class="tok-n">stylesheet</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">path</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">path</span><span class="tok-p">.</span><span class="tok-n">to_str</span><span class="tok-p">().</span><span class="tok-n">expect</span><span class="tok-p">(</span><span class="tok-s">&quot;path to stylesheet unreadable&quot;</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">stylesheet</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-p">.</span><span class="tok-n">io</span><span class="tok-p">.</span><span class="tok-n">read_to_string</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">context</span><span class="tok-p">.</span><span class="tok-n">insert</span><span class="tok-p">(</span><span class="tok-s">&quot;stylesheet&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">stylesheet</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nb">None</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">context</span><span class="tok-p">.</span><span class="tok-n">insert</span><span class="tok-p">(</span><span class="tok-s">&quot;stylesheet&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">include_str</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-s">&quot;assets/asciidoctor.css&quot;</span><span class="tok-p">));</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">context</span><span class="tok-p">.</span><span class="tok-n">insert</span><span class="tok-p">(</span><span class="tok-s">&quot;body_class&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;article toc2 toc-left&quot;</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">context</span><span class="tok-p">.</span><span class="tok-n">insert</span><span class="tok-p">(</span><span class="tok-s">&quot;body&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">std</span>::<span class="tok-kt">str</span>::<span class="tok-n">from_utf8</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">bytes</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">);</span><span class="tok-w"></span>

<span class="tok-w">    </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">tera</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Tera</span>::<span class="tok-n">default</span><span class="tok-p">();</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">tera</span><span class="tok-p">.</span><span class="tok-n">autoescape_on</span><span class="tok-p">(</span><span class="tok-n">vec</span><span class="tok-o">!</span><span class="tok-p">[]);</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">args</span><span class="tok-p">.</span><span class="tok-n">template</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">path</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">path</span><span class="tok-p">.</span><span class="tok-n">to_str</span><span class="tok-p">().</span><span class="tok-n">expect</span><span class="tok-p">(</span><span class="tok-s">&quot;path to stylesheet unreadable&quot;</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">template</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-p">.</span><span class="tok-n">io</span><span class="tok-p">.</span><span class="tok-n">read_to_string</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">tera</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">.</span><span class="tok-n">add_raw_template</span><span class="tok-p">(</span><span class="tok-s">&quot;default.html&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">template</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">.</span><span class="tok-n">expect</span><span class="tok-p">(</span><span class="tok-s">&quot;couldn&#39;t load default template&quot;</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nb">None</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">tera</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">.</span><span class="tok-n">add_raw_template</span><span class="tok-p">(</span><span class="tok-s">&quot;default.html&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">include_str</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-s">&quot;assets/template.html&quot;</span><span class="tok-p">))</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">.</span><span class="tok-n">expect</span><span class="tok-p">(</span><span class="tok-s">&quot;couldn&#39;t load default template&quot;</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-n">tera</span><span class="tok-p">.</span><span class="tok-n">render</span><span class="tok-p">(</span><span class="tok-s">&quot;default.html&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">context</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">.</span><span class="tok-n">as_bytes</span><span class="tok-p">())</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">flush</span><span class="tok-p">()</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">    </span><span class="tok-nb">Ok</span><span class="tok-p">(())</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">fn</span> <span class="tok-nf">escape_text</span><span class="tok-p">(</span><span class="tok-n">input</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nb">String</span> <span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">replace</span><span class="tok-p">(</span><span class="tok-s">&quot;&lt;&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;&amp;lt;&quot;</span><span class="tok-p">).</span><span class="tok-n">replace</span><span class="tok-p">(</span><span class="tok-s">&quot;&gt;&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;&amp;gt;&quot;</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-c1">// TODO Styles etc</span>
<span class="tok-k">fn</span> <span class="tok-nf">write_html</span><span class="tok-o">&lt;</span><span class="tok-n">T</span>: <span class="tok-nc">io</span>::<span class="tok-n">Write</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-n">input</span>: <span class="tok-kp">&amp;</span><span class="tok-nc">ElementSpan</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">out</span>: <span class="tok-kp">&amp;</span><span class="tok-nc">mut</span><span class="tok-w"> </span><span class="tok-n">T</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-p">()</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">&lt;&lt;</span><span class="tok-n">format_html_element</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Element</span>::<span class="tok-n">Text</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">content</span><span class="tok-p">.</span><span class="tok-n">as_bytes</span><span class="tok-p">())</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Element</span>::<span class="tok-n">Styled</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">style</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">get_attribute</span><span class="tok-p">(</span><span class="tok-s">&quot;style&quot;</span><span class="tok-p">).</span><span class="tok-n">unwrap_or</span><span class="tok-p">(</span><span class="tok-s">&quot;&quot;</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">content</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">get_attribute</span><span class="tok-p">(</span><span class="tok-s">&quot;content&quot;</span><span class="tok-p">).</span><span class="tok-n">unwrap_or</span><span class="tok-p">(</span><span class="tok-s">&quot;&quot;</span><span class="tok-p">);</span><span class="tok-w"></span>

<span class="tok-w">      </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">style</span><span class="tok-w"> </span><span class="tok-o">==</span><span class="tok-w"> </span><span class="tok-s">&quot;monospaced&quot;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-s">b&quot;&lt;code&gt;&quot;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-k">else</span><span class="tok-w"> </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">style</span><span class="tok-w"> </span><span class="tok-o">==</span><span class="tok-w"> </span><span class="tok-s">&quot;strong&quot;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-s">b&quot;&lt;strong&gt;&quot;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">      </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-n">content</span><span class="tok-p">.</span><span class="tok-n">as_bytes</span><span class="tok-p">())</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">      </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">style</span><span class="tok-w"> </span><span class="tok-o">==</span><span class="tok-w"> </span><span class="tok-s">&quot;monospaced&quot;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-s">b&quot;&lt;/code&gt;&quot;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-k">else</span><span class="tok-w"> </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">style</span><span class="tok-w"> </span><span class="tok-o">==</span><span class="tok-w"> </span><span class="tok-s">&quot;strong&quot;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-s">b&quot;&lt;/strong&gt;&quot;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-o">&amp;</span><span class="tok-n">format</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-s">&quot;&lt;NOT-YET-SUPPORTED:{:?}&gt;{}&lt;/NOT-YET-SUPPORTED:{:?}&gt;</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">content</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">.</span><span class="tok-n">as_bytes</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-nb">Ok</span><span class="tok-p">(())</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
</pre></td></tr></table></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_überschriften_2">Überschriften</h5>
<div id="format_html_element" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-n">Element</span>::<span class="tok-n">Title</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-n">level</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">title</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">get_attribute</span><span class="tok-p">(</span><span class="tok-s">&quot;name&quot;</span><span class="tok-p">).</span><span class="tok-n">unwrap_or</span><span class="tok-p">(</span><span class="tok-s">&quot;&quot;</span><span class="tok-p">);</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">format</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-s">&quot;&lt;h{}&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">level</span><span class="tok-p">).</span><span class="tok-n">as_bytes</span><span class="tok-p">())</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">level</span><span class="tok-w"> </span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">get_attribute</span><span class="tok-p">(</span><span class="tok-s">&quot;anchor&quot;</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">id</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-n">id</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nb">None</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-s">&quot;_&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">title</span><span class="tok-p">.</span><span class="tok-n">replace</span><span class="tok-p">(</span><span class="tok-s">&quot; &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;_&quot;</span><span class="tok-p">).</span><span class="tok-n">to_lowercase</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">format</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-s">&quot; id=</span><span class="tok-se">\&quot;</span><span class="tok-s">{}</span><span class="tok-se">\&quot;</span><span class="tok-s">&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">id</span><span class="tok-p">).</span><span class="tok-n">as_bytes</span><span class="tok-p">())</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">};</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">format</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-s">&quot;&gt;{}&lt;/h{}&gt;</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">title</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">level</span><span class="tok-p">).</span><span class="tok-n">as_bytes</span><span class="tok-p">())</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_absätze_2">Absätze</h5>
<div id="format_html_element" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-n">Element</span>::<span class="tok-n">Paragraph</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-s">b&quot;&lt;p&gt;&quot;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">children</span><span class="tok-p">.</span><span class="tok-n">iter</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">write_html</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">out</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-s">b&quot;&lt;/p&gt;</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_listen_2">Listen</h5>
<div id="format_html_element" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-n">Element</span>::<span class="tok-n">List</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">level</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mi">1</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-s">b&quot;&lt;ul&gt;</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">children</span><span class="tok-p">.</span><span class="tok-n">iter</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">Element</span>::<span class="tok-n">ListItem</span><span class="tok-p">(</span><span class="tok-n">item_level</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-p">.</span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">item_level</span><span class="tok-w"> </span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-n">level</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-s">b&quot;&lt;ul&gt;</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">level</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">item_level</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-k">else</span><span class="tok-w"> </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">item_level</span><span class="tok-w"> </span><span class="tok-o">&lt;</span><span class="tok-w"> </span><span class="tok-n">level</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-s">b&quot;&lt;/ul&gt;</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">level</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">item_level</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">write_html</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">out</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-s">b&quot;&lt;/ul&gt;</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-n">Element</span>::<span class="tok-n">ListItem</span><span class="tok-p">(</span><span class="tok-n">_level</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-s">b&quot;&lt;li&gt;</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">element</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">children</span><span class="tok-p">.</span><span class="tok-n">iter</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">write_html</span><span class="tok-p">(</span><span class="tok-n">element</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">out</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-s">b&quot;&lt;/li&gt;</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_sourcecode_blocke">Sourcecode Blocke</h5>
<div id="format_html_element" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-n">Element</span>::<span class="tok-n">TypedBlock</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-n">kind</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">kind</span><span class="tok-w"> </span><span class="tok-o">==</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">BlockType</span>::<span class="tok-n">Comment</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-c1">// Comments are not printed in html</span>
<span class="tok-w">    </span><span class="tok-c1">// TODO provide option to print comments</span>
<span class="tok-w">    </span><span class="tok-k">return</span><span class="tok-w"> </span><span class="tok-nb">Ok</span><span class="tok-p">(());</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-s">b&quot;&lt;div &quot;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">id</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">get_attribute</span><span class="tok-p">(</span><span class="tok-s">&quot;anchor&quot;</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">format</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-s">&quot;id=</span><span class="tok-se">\&quot;</span><span class="tok-s">{}</span><span class="tok-se">\&quot;</span><span class="tok-s"> &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">id</span><span class="tok-p">).</span><span class="tok-n">as_bytes</span><span class="tok-p">())</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">};</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">class</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">kind</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">BlockType</span>::<span class="tok-n">Listing</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-s">&quot;listingblock&quot;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-s">&quot;unknown-block&quot;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">format</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-s">&quot;class=</span><span class="tok-se">\&quot;</span><span class="tok-s">{}</span><span class="tok-se">\&quot;</span><span class="tok-s">&gt;</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">class</span><span class="tok-p">).</span><span class="tok-n">as_bytes</span><span class="tok-p">())</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">title</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">get_attribute</span><span class="tok-p">(</span><span class="tok-s">&quot;title&quot;</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">format</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-s">&quot;&lt;div class=</span><span class="tok-se">\&quot;</span><span class="tok-s">title</span><span class="tok-se">\&quot;</span><span class="tok-s">&gt;{}&lt;/div&gt;</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">title</span><span class="tok-p">).</span><span class="tok-n">as_bytes</span><span class="tok-p">())</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">};</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">kind</span><span class="tok-w"> </span><span class="tok-o">==</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">BlockType</span>::<span class="tok-n">Listing</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-s">b&quot;&lt;pre&gt;&quot;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">content</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">get_attribute</span><span class="tok-p">(</span><span class="tok-s">&quot;content&quot;</span><span class="tok-p">).</span><span class="tok-n">unwrap_or</span><span class="tok-p">(</span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">content</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-n">escape_text</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">content</span><span class="tok-p">).</span><span class="tok-n">as_bytes</span><span class="tok-p">())</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">kind</span><span class="tok-w"> </span><span class="tok-o">==</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">BlockType</span>::<span class="tok-n">Listing</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-s">b&quot;&lt;/pre&gt;</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-s">b&quot;&lt;/div&gt;</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_links_2">Links</h5>
<div id="format_html_element" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-n">Element</span>::<span class="tok-n">Link</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">url</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">get_attribute</span><span class="tok-p">(</span><span class="tok-s">&quot;url&quot;</span><span class="tok-p">).</span><span class="tok-n">unwrap_or</span><span class="tok-p">(</span><span class="tok-s">&quot;&quot;</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">content</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">positional_attributes</span><span class="tok-p">.</span><span class="tok-n">get</span><span class="tok-p">(</span><span class="tok-mi">0</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">value</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">value</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">AttributeValue</span>::<span class="tok-n">Ref</span><span class="tok-p">(</span><span class="tok-n">value</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-n">value</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">AttributeValue</span>::<span class="tok-nb">String</span><span class="tok-p">(</span><span class="tok-n">value</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-n">value</span><span class="tok-p">.</span><span class="tok-n">clone</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">},</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nb">None</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-s">&quot;&quot;</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">};</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">format</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-s">&quot;&lt;a href=</span><span class="tok-se">\&quot;</span><span class="tok-s">{}</span><span class="tok-se">\&quot;</span><span class="tok-s">&gt;{}&lt;/a&gt;&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">url</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">content</span><span class="tok-p">).</span><span class="tok-n">as_bytes</span><span class="tok-p">())</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_querverweise_2">Querverweise</h5>
<div id="format_html_element" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-n">Element</span>::<span class="tok-n">XRef</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">get_attribute</span><span class="tok-p">(</span><span class="tok-s">&quot;id&quot;</span><span class="tok-p">).</span><span class="tok-n">unwrap_or</span><span class="tok-p">(</span><span class="tok-s">&quot;&quot;</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">content</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">get_attribute</span><span class="tok-p">(</span><span class="tok-s">&quot;content&quot;</span><span class="tok-p">).</span><span class="tok-n">unwrap_or</span><span class="tok-p">(</span><span class="tok-n">id</span><span class="tok-p">.</span><span class="tok-n">clone</span><span class="tok-p">());</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">format</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-s">&quot;&lt;a href=</span><span class="tok-se">\&quot;</span><span class="tok-s">#{}</span><span class="tok-se">\&quot;</span><span class="tok-s">&gt;{}&lt;/a&gt;&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">id</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">content</span><span class="tok-p">).</span><span class="tok-n">as_bytes</span><span class="tok-p">())</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_fußnoten_2">Fußnoten</h5>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect4">
<h5 id="_bilder_2">Bilder</h5>
<div class="paragraph">
<p>TODO Bilder einbetten, entweder als Daten oder z.B. direkt als svg.
TODO Fehler wenn keine Attribute vorhanden sind</p>
</div>
<div id="format_html_element" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-n">Element</span>::<span class="tok-n">Image</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">get_attribute</span><span class="tok-p">(</span><span class="tok-s">&quot;path&quot;</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">get_attribute</span><span class="tok-p">(</span><span class="tok-s">&quot;opts&quot;</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">options</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">content</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">input</span><span class="tok-p">.</span><span class="tok-n">get_attribute</span><span class="tok-p">(</span><span class="tok-s">&quot;content&quot;</span><span class="tok-p">).</span><span class="tok-n">unwrap_or</span><span class="tok-p">(</span><span class="tok-s">&quot;&quot;</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">options</span><span class="tok-w"> </span><span class="tok-o">==</span><span class="tok-w"> </span><span class="tok-s">&quot;inline&quot;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">path</span><span class="tok-p">.</span><span class="tok-n">ends_with</span><span class="tok-p">(</span><span class="tok-s">&quot;.svg&quot;</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-n">content</span><span class="tok-p">.</span><span class="tok-n">as_bytes</span><span class="tok-p">())</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-c1">// TODO</span>
<span class="tok-w">        </span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-k">else</span><span class="tok-w"> </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">options</span><span class="tok-w"> </span><span class="tok-o">==</span><span class="tok-w"> </span><span class="tok-s">&quot;interactive&quot;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-c1">// TODO</span>
<span class="tok-w">        </span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-k">else</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-c1">// TODO</span>
<span class="tok-w">        </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nb">None</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">format</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-s">&quot;&lt;img src=</span><span class="tok-se">\&quot;</span><span class="tok-s">{}</span><span class="tok-se">\&quot;</span><span class="tok-s">&gt;&lt;/div&gt;</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">path</span><span class="tok-p">).</span><span class="tok-n">as_bytes</span><span class="tok-p">())</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tabellen_2">Tabellen</h5>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect4">
<h5 id="_inhaltsverzeichnis">Inhaltsverzeichnis</h5>
<div class="paragraph">
<p>TODO</p>
</div>
<div class="paragraph">
<p>Unresolved directive in asciidoctrine.adoc - include::src/output/docbook.adoc[]
Unresolved directive in asciidoctrine.adoc - include::src/output/manpage.adoc[]
Unresolved directive in asciidoctrine.adoc - include::src/output/pdf.adoc[]
Unresolved directive in asciidoctrine.adoc - include::src/output/json-ast.adoc[]</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_json_2">Json</h4>
<div class="listingblock">
<div class="title">src/writer/json.rs</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><table class="linenotable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><pre><span></span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-n">ast</span>::<span class="tok-o">*</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-p">{</span><span class="tok-n">options</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nb">Result</span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">std</span>::<span class="tok-n">io</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">struct</span> <span class="tok-nc">JsonWriter</span><span class="tok-w"> </span><span class="tok-p">{}</span><span class="tok-w"></span>

<span class="tok-k">impl</span><span class="tok-w"> </span><span class="tok-n">JsonWriter</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">fn</span> <span class="tok-nf">new</span><span class="tok-p">()</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">Self</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">JsonWriter</span><span class="tok-w"> </span><span class="tok-p">{}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">impl</span><span class="tok-o">&lt;</span><span class="tok-n">T</span>: <span class="tok-nc">io</span>::<span class="tok-n">Write</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-k">crate</span>::<span class="tok-n">Writer</span><span class="tok-o">&lt;</span><span class="tok-n">T</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">JsonWriter</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">fn</span> <span class="tok-nf">write</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">ast</span>: <span class="tok-nc">AST</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">_args</span>: <span class="tok-kp">&amp;</span><span class="tok-nc">options</span>::<span class="tok-n">Opts</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">out</span>: <span class="tok-nc">T</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-p">()</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">write_all</span><span class="tok-p">(</span><span class="tok-n">serde_json</span>::<span class="tok-n">to_string_pretty</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">ast</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">.</span><span class="tok-n">as_bytes</span><span class="tok-p">())</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">out</span><span class="tok-p">.</span><span class="tok-n">flush</span><span class="tok-p">()</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">    </span><span class="tok-nb">Ok</span><span class="tok-p">(())</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
</pre></td></tr></table></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_asciidoctrine_in_andere_programme_einbinden">asciidoctrine in andere Programme einbinden</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TODO</p>
</div>
<div class="sect2">
<h3 id="cmd-api">Aufruf auf der Kommandozeile</h3>
<div class="paragraph">
<p>Der einfachste Weg asciidoctrine in ein anderes Programm einzubinden ist es über der Kommandozeile aufzurufen.</p>
</div>
<div class="listingblock">
<div class="title">src/options.rs</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><table class="linenotable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69</pre></div></td><td class="code"><pre><span></span><span class="tok-k">extern</span><span class="tok-w"> </span><span class="tok-k">crate</span><span class="tok-w"> </span><span class="tok-n">clap</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">clap</span>::<span class="tok-n">arg_enum</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">std</span>::<span class="tok-n">error</span>::<span class="tok-n">Error</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">std</span>::<span class="tok-n">path</span>::<span class="tok-n">PathBuf</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">structopt</span>::<span class="tok-n">StructOpt</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-sd">/// Parse a single key-value pair</span>
<span class="tok-k">fn</span> <span class="tok-nf">parse_key_val</span><span class="tok-o">&lt;</span><span class="tok-n">T</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">U</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-n">s</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-p">(</span><span class="tok-n">T</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">U</span><span class="tok-p">),</span><span class="tok-w"> </span><span class="tok-nb">Box</span><span class="tok-o">&lt;</span><span class="tok-n">dyn</span><span class="tok-w"> </span><span class="tok-n">Error</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"></span>
<span class="tok-k">where</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">T</span>: <span class="tok-nc">std</span>::<span class="tok-kt">str</span>::<span class="tok-n">FromStr</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">T</span>::<span class="tok-nb">Err</span>: <span class="tok-nc">Error</span><span class="tok-w"> </span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-nb">&#39;static</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">U</span>: <span class="tok-nc">std</span>::<span class="tok-kt">str</span>::<span class="tok-n">FromStr</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">U</span>::<span class="tok-nb">Err</span>: <span class="tok-nc">Error</span><span class="tok-w"> </span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-nb">&#39;static</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">pos</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">s</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">.</span><span class="tok-n">find</span><span class="tok-p">(</span><span class="tok-sc">&#39;=&#39;</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">.</span><span class="tok-n">ok_or_else</span><span class="tok-p">(</span><span class="tok-o">||</span><span class="tok-w"> </span><span class="tok-n">format</span><span class="tok-o">!</span><span class="tok-p">(</span><span class="tok-s">&quot;invalid KEY=value: no `=` found in `{}`&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">s</span><span class="tok-p">))</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-nb">Ok</span><span class="tok-p">((</span><span class="tok-n">s</span><span class="tok-p">[..</span><span class="tok-n">pos</span><span class="tok-p">].</span><span class="tok-n">parse</span><span class="tok-p">()</span><span class="tok-o">?</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">s</span><span class="tok-p">[</span><span class="tok-n">pos</span><span class="tok-w"> </span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-mi">1</span><span class="tok-p">..].</span><span class="tok-n">parse</span><span class="tok-p">()</span><span class="tok-o">?</span><span class="tok-p">))</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-n">arg_enum</span><span class="tok-o">!</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[derive(StructOpt, Debug)]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">enum</span> <span class="tok-nc">Reader</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Asciidoc</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Json</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-n">arg_enum</span><span class="tok-o">!</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[derive(StructOpt, Debug)]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">enum</span> <span class="tok-nc">Writer</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Html5</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Docbook</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Pdf</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Json</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-c1">// The asciidoc output makes it possible</span>
<span class="tok-w">    </span><span class="tok-c1">// to use this tool as a preprocessor for</span>
<span class="tok-w">    </span><span class="tok-c1">// other asciidoc tools while it is maturing</span>
<span class="tok-w">    </span><span class="tok-n">Asciidoc</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-cp">#[derive(StructOpt, Debug)]</span><span class="tok-w"></span>
<span class="tok-cp">#[structopt(name = </span><span class="tok-s">&quot;asciidoctrine&quot;</span><span class="tok-cp">)]</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">struct</span> <span class="tok-nc">Opts</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[structopt(short = </span><span class="tok-s">&quot;r&quot;</span><span class="tok-cp">, long = </span><span class="tok-s">&quot;reader-format&quot;</span><span class="tok-cp">, default_value = </span><span class="tok-s">&quot;asciidoc&quot;</span><span class="tok-cp">)]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[structopt(possible_values = &amp;Reader::variants(), case_insensitive = true)]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">readerfmt</span>: <span class="tok-nc">Reader</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[structopt(short = </span><span class="tok-s">&quot;w&quot;</span><span class="tok-cp">, long = </span><span class="tok-s">&quot;writer-format&quot;</span><span class="tok-cp">, default_value = </span><span class="tok-s">&quot;html5&quot;</span><span class="tok-cp">)]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[structopt(possible_values = &amp;Writer::variants(), case_insensitive = true)]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">writerfmt</span>: <span class="tok-nc">Writer</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[structopt(short = </span><span class="tok-s">&quot;e&quot;</span><span class="tok-cp">, long = </span><span class="tok-s">&quot;extension&quot;</span><span class="tok-cp">)]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">extensions</span>: <span class="tok-nb">Vec</span><span class="tok-o">&lt;</span><span class="tok-nb">String</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[structopt(long, parse(from_os_str))]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">template</span>: <span class="tok-nb">Option</span><span class="tok-o">&lt;</span><span class="tok-n">PathBuf</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[structopt(long, parse(from_os_str))]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">stylesheet</span>: <span class="tok-nb">Option</span><span class="tok-o">&lt;</span><span class="tok-n">PathBuf</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[structopt(short = </span><span class="tok-s">&quot;a&quot;</span><span class="tok-cp">, long = </span><span class="tok-s">&quot;attribute&quot;</span><span class="tok-cp">, parse(try_from_str = parse_key_val), number_of_values = 1)]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">defines</span>: <span class="tok-nb">Vec</span><span class="tok-o">&lt;</span><span class="tok-p">(</span><span class="tok-nb">String</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nb">String</span><span class="tok-p">)</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[structopt(name = </span><span class="tok-s">&quot;FILE&quot;</span><span class="tok-cp">, parse(from_os_str))]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">input</span>: <span class="tok-nb">Option</span><span class="tok-o">&lt;</span><span class="tok-n">PathBuf</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[structopt(short = </span><span class="tok-s">&quot;o&quot;</span><span class="tok-cp">, parse(from_os_str))]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">output</span>: <span class="tok-nb">Option</span><span class="tok-o">&lt;</span><span class="tok-n">PathBuf</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">fn</span> <span class="tok-nf">from_args</span><span class="tok-p">()</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">Opts</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Opts</span>::<span class="tok-n">from_args</span><span class="tok-p">()</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
</pre></td></tr></table></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="extensions">asciidoctrine erweitern</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Man kann <code>asciidoctrine</code> über eine api Schnittstelle erweitern. Dazu werden für alle wichtigen Funktionen Schnittstellen definiert, welche von der jeweiligen Erweiterung implementiert werden müssen.</p>
</div>
<div class="sect2">
<h3 id="reader">Neue Datenformate einlesen</h3>
<div class="paragraph">
<p>Jedes Eingabeformat muss zunächst in einen <a href="#ast">Der Abstract Syntax Tree</a> ungewandelt werden um von asciidoctrine verarebitet werden zu können. Auch alle intern unterstützten Dateiformate implementieren die gleiche Schnittstelle.</p>
</div>
<div id="interfaces" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">trait</span><span class="tok-w"> </span><span class="tok-n">Reader</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">fn</span> <span class="tok-nf">parse</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">input</span>: <span class="tok-kp">&amp;</span><span class="tok-na">&#39;a</span><span class="tok-w"> </span><span class="tok-kt">str</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">args</span>: <span class="tok-kp">&amp;</span><span class="tok-nc">options</span>::<span class="tok-n">Opts</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">env</span>: <span class="tok-kp">&amp;</span><span class="tok-nc">mut</span><span class="tok-w"> </span><span class="tok-n">util</span>::<span class="tok-n">Env</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-n">AST</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;&gt;</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="extension">Den AST verarbeiten/modifizieren</h3>
<div class="paragraph">
<p>Manchmal will man den <a href="#ast">Der Abstract Syntax Tree</a> verarbeiten und daraus Informationen nutzen (lisa TODO link) verwendet ihn z.B. um daraus Quelltext-Dateien zu extrahieren). Das ermöglicht sehr viele Anwendungsfälle:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Daten extrahieren und Prüfungen oder Statistiken damit durchführen</p>
</li>
<li>
<p>Rechtschreibprüfung durchführen</p>
</li>
<li>
<p>Mehrere Dokumente vereinen</p>
</li>
<li>
<p>etc</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Für alle diese Funktionen definieren wir eine Schnittstelle welche einen AST einließt und am Ende einen AST ausgibt. Wie er zwischendurch verarbeitet wird und ob er modifiziert wird bleibt vollständig der Erweiterung überlassen.</p>
</div>
<div id="interfaces" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">trait</span><span class="tok-w"> </span><span class="tok-n">Extension</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-c1">// TODO Options (Kann auch über Attributes in AST gemacht werden)</span>
<span class="tok-w">  </span><span class="tok-k">fn</span> <span class="tok-nf">transform</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">input</span>: <span class="tok-nc">AST</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">anyhow</span>::<span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-n">AST</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;&gt;</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writer">Neue Ausgabeformate unterstützen</h3>
<div class="paragraph">
<p>Um ein weiteres Ausgabeformat zu implementieren muss die entsprechende Schnittstelle implementiert werden. Sie konsumiert einen <a href="#ast">Der Abstract Syntax Tree</a> und ist dafür verantwortlich eine Datei zu erstellen, welche das Ausgabeformat verwendet.</p>
</div>
<div id="interfaces" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">trait</span><span class="tok-w"> </span><span class="tok-n">Writer</span><span class="tok-o">&lt;</span><span class="tok-n">T</span>: <span class="tok-nc">io</span>::<span class="tok-n">Write</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-c1">// TODO Result zurückgeben mit Fehler oder Liste der Geschriebenen Dateien</span>
<span class="tok-w">  </span><span class="tok-k">fn</span> <span class="tok-nf">write</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">ast</span>: <span class="tok-nc">AST</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">args</span>: <span class="tok-kp">&amp;</span><span class="tok-nc">options</span>::<span class="tok-n">Opts</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">out</span>: <span class="tok-nc">T</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-p">()</span><span class="tok-o">&gt;</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ast">Der Abstract Syntax Tree</h3>
<div class="paragraph">
<p>Alle Schnittstellen basieren auf der gleichen Datenstrucktur. Diese bildet ein Dokument vollständig ab.</p>
</div>
<div class="listingblock">
<div class="title">src/ast.rs</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><table class="linenotable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><pre><span></span><span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">serde</span>::<span class="tok-p">{</span><span class="tok-n">Deserialize</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">Serialize</span><span class="tok-p">};</span><span class="tok-w"></span>

<span class="tok-cp">#[derive(Debug, Clone, PartialEq, Deserialize, Serialize)]</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">struct</span> <span class="tok-nc">AST</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">content</span>: <span class="tok-kp">&amp;</span><span class="tok-na">&#39;a</span><span class="tok-w"> </span><span class="tok-kt">str</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">elements</span>: <span class="tok-nb">Vec</span><span class="tok-o">&lt;</span><span class="tok-n">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">attributes</span>: <span class="tok-nb">Vec</span><span class="tok-o">&lt;</span><span class="tok-n">Attribute</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-o">&lt;&lt;</span><span class="tok-n">ast_structs</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"></span>
</pre></td></tr></table></code></pre>
</div>
</div>
<div id="ast_structs" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-k">impl</span><span class="tok-w"> </span><span class="tok-n">AST</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;_</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">fn</span> <span class="tok-nf">get_attribute</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">name</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nb">Option</span><span class="tok-o">&lt;&amp;</span><span class="tok-kt">str</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">attribute</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">iter</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">attribute</span><span class="tok-p">.</span><span class="tok-n">key</span><span class="tok-w"> </span><span class="tok-o">==</span><span class="tok-w"> </span><span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">return</span><span class="tok-w"> </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">attribute</span><span class="tok-p">.</span><span class="tok-n">value</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">AttributeValue</span>::<span class="tok-n">Ref</span><span class="tok-p">(</span><span class="tok-n">value</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">value</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">AttributeValue</span>::<span class="tok-nb">String</span><span class="tok-p">(</span><span class="tok-n">value</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">value</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">    </span><span class="tok-nb">None</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-sd">/// The basic element of a document</span>
<span class="tok-sd">///</span>
<span class="tok-sd">/// This is meant to form a tree of document element.</span>
<span class="tok-sd">/// Every element holds references to its source, it</span>
<span class="tok-sd">/// subelements and the attributes defined on it.</span>
<span class="tok-cp">#[derive(Debug, Clone, PartialEq, Deserialize, Serialize)]</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">struct</span> <span class="tok-nc">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-c1">// The source document. Could be empty if</span>
<span class="tok-w">  </span><span class="tok-c1">// e.g. it&#39;s the same as the source of it&#39;s</span>
<span class="tok-w">  </span><span class="tok-c1">// parent</span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">source</span>: <span class="tok-nb">Option</span><span class="tok-o">&lt;</span><span class="tok-nb">String</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-c1">// A string reference to the source</span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">content</span>: <span class="tok-kp">&amp;</span><span class="tok-na">&#39;a</span><span class="tok-w"> </span><span class="tok-kt">str</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-c1">// TODO Add start and end point</span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">start</span>: <span class="tok-kt">usize</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">end</span>: <span class="tok-kt">usize</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// We count the lines for usage in other tools</span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">start_line</span>: <span class="tok-kt">usize</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">start_col</span>: <span class="tok-kt">usize</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">end_line</span>: <span class="tok-kt">usize</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">end_col</span>: <span class="tok-kt">usize</span><span class="tok-p">,</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">element</span>: <span class="tok-nc">Element</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// The subelements of a nodes</span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">children</span>: <span class="tok-nb">Vec</span><span class="tok-o">&lt;</span><span class="tok-n">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// The attributes applying to that node and</span>
<span class="tok-w">  </span><span class="tok-sd">/// all children</span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">positional_attributes</span>: <span class="tok-nb">Vec</span><span class="tok-o">&lt;</span><span class="tok-n">AttributeValue</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// The attributes applying to that node and</span>
<span class="tok-w">  </span><span class="tok-sd">/// all children</span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">attributes</span>: <span class="tok-nb">Vec</span><span class="tok-o">&lt;</span><span class="tok-n">Attribute</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">impl</span><span class="tok-w"> </span><span class="tok-n">ElementSpan</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;_</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">fn</span> <span class="tok-nf">get_attribute</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">name</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nb">Option</span><span class="tok-o">&lt;&amp;</span><span class="tok-kt">str</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">attribute</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-p">.</span><span class="tok-n">attributes</span><span class="tok-p">.</span><span class="tok-n">iter</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">attribute</span><span class="tok-p">.</span><span class="tok-n">key</span><span class="tok-w"> </span><span class="tok-o">==</span><span class="tok-w"> </span><span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">return</span><span class="tok-w"> </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-o">&amp;</span><span class="tok-n">attribute</span><span class="tok-p">.</span><span class="tok-n">value</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">AttributeValue</span>::<span class="tok-n">Ref</span><span class="tok-p">(</span><span class="tok-n">value</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">value</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">          </span><span class="tok-n">AttributeValue</span>::<span class="tok-nb">String</span><span class="tok-p">(</span><span class="tok-n">value</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">value</span><span class="tok-p">.</span><span class="tok-n">as_str</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">    </span><span class="tok-nb">None</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-cp">#[derive(Debug, Clone, PartialEq, Deserialize, Serialize)]</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">enum</span> <span class="tok-nc">Element</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Attribute</span><span class="tok-p">(</span><span class="tok-cp">#[serde(borrow)]</span><span class="tok-w"> </span><span class="tok-n">Attribute</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// A section of ignored text</span>
<span class="tok-w">  </span><span class="tok-n">Comment</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// A text paragraph</span>
<span class="tok-w">  </span><span class="tok-n">Paragraph</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// A header section</span>
<span class="tok-w">  </span><span class="tok-n">Title</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">level</span>: <span class="tok-kt">u32</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">},</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Table</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">List</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Image</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Anchor</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// Holds all blocks with special content and the type</span>
<span class="tok-w">  </span><span class="tok-sd">/// TODO Could be done with ExternalContent and all known</span>
<span class="tok-w">  </span><span class="tok-sd">/// Types here direktly</span>
<span class="tok-w">  </span><span class="tok-n">TypedBlock</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">kind</span>: <span class="tok-nc">BlockType</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">},</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// Holds content which is not przessed direktly by</span>
<span class="tok-w">  </span><span class="tok-sd">/// asciidoctrine. It can be anything. Outputs or</span>
<span class="tok-w">  </span><span class="tok-sd">/// postprocessors could use or ignore it at their</span>
<span class="tok-w">  </span><span class="tok-sd">/// will (e.g. videos)</span>
<span class="tok-w">  </span><span class="tok-n">ExternalContent</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// Holds a reference to the include statement</span>
<span class="tok-w">  </span><span class="tok-sd">/// and a document inside</span>
<span class="tok-w">  </span><span class="tok-n">IncludeElement</span><span class="tok-p">(</span><span class="tok-n">IncludeElement</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">),</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-sd">/// The following variants are inline elements nested</span>
<span class="tok-w">  </span><span class="tok-sd">/// inside a conainer element</span>

<span class="tok-w">  </span><span class="tok-sd">/// Element with a special style. The attributes define the kind of style</span>
<span class="tok-w">  </span><span class="tok-n">Styled</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// A chunk of text.</span>
<span class="tok-w">  </span><span class="tok-n">Text</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// An internal reference or link</span>
<span class="tok-w">  </span><span class="tok-n">XRef</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// An external link</span>
<span class="tok-w">  </span><span class="tok-n">Link</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// A list item</span>
<span class="tok-w">  </span><span class="tok-n">ListItem</span><span class="tok-p">(</span><span class="tok-kt">u32</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// A table row</span>
<span class="tok-w">  </span><span class="tok-n">TableRow</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// A table cell</span>
<span class="tok-w">  </span><span class="tok-n">TableCell</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-sd">/// A wrong formatted text or block</span>
<span class="tok-w">  </span><span class="tok-n">Error</span><span class="tok-p">(</span><span class="tok-nb">String</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-cp">#[derive(Debug, Clone, PartialEq, Deserialize, Serialize)]</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">enum</span> <span class="tok-nc">BlockType</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Comment</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Passtrough</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Listing</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Literal</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Sidebar</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Quote</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Example</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-cp">#[derive(Debug, Clone, PartialEq, Deserialize, Serialize)]</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">enum</span> <span class="tok-nc">AttributeValue</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-nb">String</span><span class="tok-p">(</span><span class="tok-nb">String</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Ref</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-na">&#39;a</span><span class="tok-w"> </span><span class="tok-kt">str</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-cp">#[derive(Debug, Clone, PartialEq, Deserialize, Serialize)]</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">struct</span> <span class="tok-nc">Attribute</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">key</span>: <span class="tok-nb">String</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[serde(borrow)]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">value</span>: <span class="tok-nc">AttributeValue</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-cp">#[derive(Debug, Clone, PartialEq, Deserialize, Serialize)]</span><span class="tok-w"></span>
<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">struct</span> <span class="tok-nc">IncludeElement</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-cp">#[serde(borrow)]</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-n">inner</span>: <span class="tok-nc">AST</span><span class="tok-o">&lt;</span><span class="tok-na">&#39;a</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Jedes Dokument ist im Großen und Ganzen eine Ansammlung von hintereinander liegenden Strukturelementen (wie Überschriften, Texten, etc). In unserem Fall hat ein Dokument zusätzlich noch Eigenschaften welche ihm zugewiesen werden können.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tmp_implementierung">tmp Implementierung</h2>
<div class="sectionbody">
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>Im Fehlerfall ist es nicht immer gut gleich das Programm zu beenden. Damit der Benutzer dennoch darauf reagieren kann geben wir bei Bedarf log-Meldungen aus. Dazu benötigen wir den entspechenden Crate.</p>
</div>
<div id="crate_usages" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-cp">#[macro_use]</span><span class="tok-w"></span>
<span class="tok-k">extern</span><span class="tok-w"> </span><span class="tok-k">crate</span><span class="tok-w"> </span><span class="tok-n">log</span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">src/util.rs</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><table class="linenotable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103</pre></div></td><td class="code"><pre><span></span><span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">std</span>::<span class="tok-n">collections</span>::<span class="tok-n">HashMap</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">std</span>::<span class="tok-n">fs</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">std</span>::<span class="tok-n">io</span>::<span class="tok-p">{</span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">ErrorKind</span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">std</span>::<span class="tok-n">path</span>::<span class="tok-n">Path</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">trait</span><span class="tok-w"> </span><span class="tok-n">Environment</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">fn</span> <span class="tok-nf">read_to_string</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">path</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">crate</span>::<span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-nb">String</span><span class="tok-o">&gt;</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">fn</span> <span class="tok-nf">write</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">path</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">content</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">crate</span>::<span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-p">()</span><span class="tok-o">&gt;</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">struct</span> <span class="tok-nc">Io</span><span class="tok-w"> </span><span class="tok-p">{}</span><span class="tok-w"></span>

<span class="tok-k">impl</span><span class="tok-w"> </span><span class="tok-n">Io</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">fn</span> <span class="tok-nf">new</span><span class="tok-p">()</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">Self</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Io</span><span class="tok-w"> </span><span class="tok-p">{}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">impl</span><span class="tok-w"> </span><span class="tok-n">Environment</span><span class="tok-w"> </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">Io</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">fn</span> <span class="tok-nf">read_to_string</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">path</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">crate</span>::<span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-nb">String</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nb">Ok</span><span class="tok-p">(</span><span class="tok-n">fs</span>::<span class="tok-n">read_to_string</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-k">fn</span> <span class="tok-nf">write</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">path</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">content</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">crate</span>::<span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-p">()</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">path</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Path</span>::<span class="tok-n">new</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">path</span><span class="tok-p">.</span><span class="tok-n">parent</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-o">!</span><span class="tok-n">path</span><span class="tok-p">.</span><span class="tok-n">exists</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-n">fs</span>::<span class="tok-n">create_dir_all</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">    </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">path</span><span class="tok-p">.</span><span class="tok-n">exists</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">old_content</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">fs</span>::<span class="tok-n">read_to_string</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-n">old_content</span><span class="tok-w"> </span><span class="tok-o">==</span><span class="tok-w"> </span><span class="tok-n">content</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">return</span><span class="tok-w"> </span><span class="tok-nb">Ok</span><span class="tok-p">(());</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">fs</span>::<span class="tok-n">write</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">content</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">    </span><span class="tok-nb">Ok</span><span class="tok-p">(())</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">struct</span> <span class="tok-nc">Cache</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">files</span>: <span class="tok-nc">HashMap</span><span class="tok-o">&lt;</span><span class="tok-nb">String</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nb">String</span><span class="tok-o">&gt;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">impl</span><span class="tok-w"> </span><span class="tok-n">Cache</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">fn</span> <span class="tok-nf">new</span><span class="tok-p">()</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">Self</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-n">Cache</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">files</span>: <span class="tok-nc">HashMap</span>::<span class="tok-n">default</span><span class="tok-p">(),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">fn</span> <span class="tok-nf">get_files</span><span class="tok-p">(</span><span class="tok-bp">self</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">HashMap</span><span class="tok-o">&lt;</span><span class="tok-nb">String</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nb">String</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-bp">self</span><span class="tok-p">.</span><span class="tok-n">files</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">impl</span><span class="tok-w"> </span><span class="tok-n">Environment</span><span class="tok-w"> </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">Cache</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">fn</span> <span class="tok-nf">read_to_string</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">path</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">crate</span>::<span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-nb">String</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nb">Ok</span><span class="tok-p">(</span><span class="tok-bp">self</span><span class="tok-p">.</span><span class="tok-n">files</span><span class="tok-p">.</span><span class="tok-n">remove</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">).</span><span class="tok-n">ok_or</span><span class="tok-p">(</span><span class="tok-n">io</span>::<span class="tok-n">Error</span>::<span class="tok-n">new</span><span class="tok-p">(</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">ErrorKind</span>::<span class="tok-n">NotFound</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-s">&quot;file not found in cache&quot;</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">))</span><span class="tok-o">?</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-k">fn</span> <span class="tok-nf">write</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">path</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">content</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">crate</span>::<span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-p">()</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-bp">self</span><span class="tok-p">.</span><span class="tok-n">files</span><span class="tok-p">.</span><span class="tok-n">insert</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">(),</span><span class="tok-w"> </span><span class="tok-n">content</span><span class="tok-p">.</span><span class="tok-n">to_string</span><span class="tok-p">());</span><span class="tok-w"></span>

<span class="tok-w">    </span><span class="tok-nb">Ok</span><span class="tok-p">(())</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">enum</span> <span class="tok-nc">Env</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Io</span><span class="tok-p">(</span><span class="tok-n">Io</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-n">Cache</span><span class="tok-p">(</span><span class="tok-n">Cache</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">impl</span><span class="tok-w"> </span><span class="tok-n">Env</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">pub</span><span class="tok-w"> </span><span class="tok-k">fn</span> <span class="tok-nf">get_cache</span><span class="tok-p">(</span><span class="tok-bp">self</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nb">Option</span><span class="tok-o">&lt;</span><span class="tok-n">HashMap</span><span class="tok-o">&lt;</span><span class="tok-nb">String</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nb">String</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Env</span>::<span class="tok-n">Io</span><span class="tok-p">(</span><span class="tok-n">_</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-nb">None</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Env</span>::<span class="tok-n">Cache</span><span class="tok-p">(</span><span class="tok-n">env</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-nb">Some</span><span class="tok-p">(</span><span class="tok-n">env</span><span class="tok-p">.</span><span class="tok-n">get_files</span><span class="tok-p">()),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-k">impl</span><span class="tok-w"> </span><span class="tok-n">Environment</span><span class="tok-w"> </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">Env</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-k">fn</span> <span class="tok-nf">read_to_string</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">path</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">crate</span>::<span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-nb">String</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Env</span>::<span class="tok-n">Io</span><span class="tok-p">(</span><span class="tok-n">env</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-n">env</span><span class="tok-p">.</span><span class="tok-n">read_to_string</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Env</span>::<span class="tok-n">Cache</span><span class="tok-p">(</span><span class="tok-n">env</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-n">env</span><span class="tok-p">.</span><span class="tok-n">read_to_string</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-w">  </span><span class="tok-k">fn</span> <span class="tok-nf">write</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">path</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">content</span>: <span class="tok-kp">&amp;</span><span class="tok-kt">str</span><span class="tok-p">)</span><span class="tok-w"> </span>-&gt; <span class="tok-nc">crate</span>::<span class="tok-nb">Result</span><span class="tok-o">&lt;</span><span class="tok-p">()</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">match</span><span class="tok-w"> </span><span class="tok-bp">self</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Env</span>::<span class="tok-n">Io</span><span class="tok-p">(</span><span class="tok-n">env</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-n">env</span><span class="tok-p">.</span><span class="tok-n">write</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">content</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-n">Env</span>::<span class="tok-n">Cache</span><span class="tok-p">(</span><span class="tok-n">env</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">=&gt;</span><span class="tok-w"> </span><span class="tok-n">env</span><span class="tok-p">.</span><span class="tok-n">write</span><span class="tok-p">(</span><span class="tok-n">path</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">content</span><span class="tok-p">),</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
</pre></td></tr></table></code></pre>
</div>
</div>
</div>
</details>
</div>
</div>
<div class="sect1">
<h2 id="_installation">Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_build">Build</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tests">Tests</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_testumgebung">Testumgebung</h3>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_verwandte_projekte">Verwandte Projekte</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Es gibt einige Projekte mit vergleichbaren Zielen und teilweise auch einer vergleichbaren Architektur wie asciidoctrine.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>asciidoc TODO</p>
</li>
<li>
<p><a href="http://asciidoctor.org">asciidoctor</a> ist der Standard um asciidoc Dokumente zu rendern. Es ist in ruby geschrieben. Da der interne AST aber nicht direkt manipulierbar ist (obwohl es natürlich Möglichkeiten für Erweiterungen und auch viele tolle Plugins gibt) scheint es mir nicht ganz so flexibel wie asciidoctrine zu sein.</p>
</li>
<li>
<p><a href="http://jgm.github.io/lunamark/doc/lunamark.html">lunamark</a> wurde ja bereits in der Einleitung erwähnt. Es war eine große Quelle der Inspiration für dieses Projekt.</p>
</li>
<li>
<p><a href="https://pandoc.org/">Pandoc</a> ist ein Projekt mit einem sehr ähnlichen Aufbau. Es ist eine großartige Software und kommt vom gleichen Autor wie lunamark. Es wurde in Haskell geschrieben. Der große Unterschied (und auch der Grund, warum ich die Ziele von asciidoctrine nicht damit erreichen kann) ist, dass es einen <a href="https://hackage.haskell.org/package/pandoc-types/docs/Text-Pandoc-Definition.html">simpleren AST</a> benutzt (denn die Ausgangssprache ist hier Markdown). Daher kann es einiges nicht abbilden was ich gerne in Dokumenten verwende.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
</div>
</div>
<style>
pre.pygments .hll { background-color: #ffffcc }
pre.pygments  { background: #f8f8f8; }
pre.pygments .tok-c { color: #408080; font-style: italic } /* Comment */
pre.pygments .tok-err { border: 1px solid #FF0000 } /* Error */
pre.pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
pre.pygments .tok-o { color: #666666 } /* Operator */
pre.pygments .tok-ch { color: #408080; font-style: italic } /* Comment.Hashbang */
pre.pygments .tok-cm { color: #408080; font-style: italic } /* Comment.Multiline */
pre.pygments .tok-cp { color: #BC7A00 } /* Comment.Preproc */
pre.pygments .tok-cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
pre.pygments .tok-c1 { color: #408080; font-style: italic } /* Comment.Single */
pre.pygments .tok-cs { color: #408080; font-style: italic } /* Comment.Special */
pre.pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
pre.pygments .tok-ge { font-style: italic } /* Generic.Emph */
pre.pygments .tok-gr { color: #FF0000 } /* Generic.Error */
pre.pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
pre.pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
pre.pygments .tok-go { color: #888888 } /* Generic.Output */
pre.pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
pre.pygments .tok-gs { font-weight: bold } /* Generic.Strong */
pre.pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
pre.pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
pre.pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
pre.pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
pre.pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
pre.pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
pre.pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
pre.pygments .tok-kt { color: #B00040 } /* Keyword.Type */
pre.pygments .tok-m { color: #666666 } /* Literal.Number */
pre.pygments .tok-s { color: #BA2121 } /* Literal.String */
pre.pygments .tok-na { color: #7D9029 } /* Name.Attribute */
pre.pygments .tok-nb { color: #008000 } /* Name.Builtin */
pre.pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
pre.pygments .tok-no { color: #880000 } /* Name.Constant */
pre.pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
pre.pygments .tok-ni { color: #999999; font-weight: bold } /* Name.Entity */
pre.pygments .tok-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
pre.pygments .tok-nf { color: #0000FF } /* Name.Function */
pre.pygments .tok-nl { color: #A0A000 } /* Name.Label */
pre.pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
pre.pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
pre.pygments .tok-nv { color: #19177C } /* Name.Variable */
pre.pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
pre.pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
pre.pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
pre.pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
pre.pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
pre.pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
pre.pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
pre.pygments .tok-sa { color: #BA2121 } /* Literal.String.Affix */
pre.pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
pre.pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
pre.pygments .tok-dl { color: #BA2121 } /* Literal.String.Delimiter */
pre.pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
pre.pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
pre.pygments .tok-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
pre.pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
pre.pygments .tok-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
pre.pygments .tok-sx { color: #008000 } /* Literal.String.Other */
pre.pygments .tok-sr { color: #BB6688 } /* Literal.String.Regex */
pre.pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
pre.pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
pre.pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
pre.pygments .tok-fm { color: #0000FF } /* Name.Function.Magic */
pre.pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
pre.pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
pre.pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
pre.pygments .tok-vm { color: #19177C } /* Name.Variable.Magic */
pre.pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</body>
</html>
